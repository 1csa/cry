(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[2],{"+nH0":function(e,t,a){"use strict";a.r(t);a("MC8Q");var n=a("/n3E"),r=(a("YdMF"),a("dVZ9")),c=(a("53cK"),a("VKn7")),i=(a("mZxn"),a("S7b9")),l=(a("oj2R"),a("/zI6")),s=a("Z32k"),o=a.n(s),u=a("JCfe"),d=a.n(u),h=a("JGaj"),p=a.n(h),m=(a("zI7Q"),a("SCaQ")),b=a("maMK"),C=a.n(b),f=(a("oeo2"),a("BmDy")),g=(a("vgpD"),a("UL5a")),y=a("ERkP"),E=a.n(y),v=(a("FLAH"),a("excc")),x=(a("TPNu"),a("VogX")),k=(a("CNt0"),a("ERsz")),w=a("uDfI"),O=k["a"].Panel;class S extends E.a.Component{constructor(e){super(e),this.handleChange=this.handleChange.bind(this),this.addNextChain=this.addNextChain.bind(this),this.deleteChain=this.deleteChain.bind(this),this.updateChain=this.updateChain.bind(this),this.state={newChainVisible:!1}}handleChange(e){}extraButton(e){return E.a.createElement(E.a.Fragment,null,E.a.createElement(x["a"],{type:"edit",style:{color:"rgb(4, 130, 220)",marginRight:"10px"},onClick:t=>this.updateChain(t,e)}),E.a.createElement(x["a"],{type:"plus",style:{color:"rgb(4, 130, 220)",marginRight:"10px"},onClick:t=>this.addNextChain(t,e)}),E.a.createElement(x["a"],{type:"close",style:{color:"red"},onClick:t=>this.deleteChain(t,e)}))}updateChain(e,t){e.stopPropagation(),e.preventDefault(),this.props.switchAddModal(t,"edit")}addNextChain(e,t){e.stopPropagation(),e.preventDefault(),this.props.switchAddModal(t,"add")}deleteChain(e,t){e.stopPropagation(),e.preventDefault(),this.props.deleteCurChain(t)}render(){var e=this.props.chainDetailList;return E.a.createElement(E.a.Fragment,null,E.a.createElement(k["a"],{accordion:!0,onChange:this.handleChange},e.map((e,t)=>{return E.a.createElement(O,{key:"".concat(e.chain_id,"-").concat(e.chain),header:e.chain,extra:this.extraButton(e)},e.childData&&e.childData.length>0?E.a.createElement(S,{chainDetailList:e.childData,switchAddModal:this.props.switchAddModal,deleteCurChain:this.props.deleteCurChain}):"\u6682\u65e0\u94fe\u8def")})))}}var _=Object(w["c"])()(S),j=(a("zH4S"),f["a"].Search),D=e=>{var t=e.source_id,a=e.dispatch,n=Object(y["useState"])([]),r=C()(n,2),c=r[0],i=r[1],s=Object(y["useState"])(!1),u=C()(s,2),h=u[0],b=u[1],g=Object(y["useState"])(!1),x=C()(g,2),k=x[0],w=x[1],O=Object(y["useState"])(""),S=C()(O,2),D=S[0],F=S[1],I=Object(y["useState"])(!1),L=C()(I,2),N=L[0],T=L[1],A=Object(y["useState"])(""),M=C()(A,2),R=M[0],J=M[1],P=Object(y["useState"])(0),V=C()(P,2),z=V[0],B=V[1],H=Object(y["useState"])(0),K=C()(H,2),q=K[0],Q=K[1],Z=Object(y["useState"])(!1),G=C()(Z,2),U=G[0],X=G[1],Y=Object(y["useState"])("\u65b0\u589e\u5b50\u94fe\u8def\u8282\u70b9"),W=C()(Y,2),$=W[0],ee=W[1],te=Object(y["useState"])("add"),ae=C()(te,2),ne=ae[0],re=ae[1],ce=Object(y["useRef"])(),ie=E.a.createElement(j,{placeholder:"\u8bf7\u8f93\u5165\u94fe\u8def\u8282\u70b9",ref:ce,value:D,onChange:e=>F(e.target.value),onSearch:()=>se(),enterButton:"ok",loading:k}),le=function(){var e=p()(o.a.mark(function e(){var n,r,c,l;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a({type:"Chain/getChainListGroup",payload:{source_id:t}});case 2:r=e.sent,c=null===r||void 0===r?void 0:r.data,c?(Object.keys(c).forEach(e=>{c[e].map(t=>t.opid=e)}),l=c[0],n=l&&l.map(e=>{function t(e){var a={};return a["chain_id"]=e["pid"],a["chain"]=e["chain"],a["pid"]=e["opid"],a["childData"]=c[e["pid"]]?c[e["pid"]].map(e=>t(e)):[],a}return t(e)})):n=[],i(n);case 6:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),se=function(){var e=p()(o.a.mark(function e(){var n,r;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return N?(n={chain:R,source_id:t,pid:~~z},X(!0)):(n={chain:D,source_id:t,pid:0},w(!0)),e.next=3,a({type:"Chain/createChain",payload:d()({},n)});case 3:if(r=e.sent,w(!1),X(!1),0!==r.code){e.next=12;break}le(),F(""),J(""),e.next=14;break;case 12:return l["a"].error({title:"\u9519\u8bef",content:JSON.stringify(r.message)}),e.abrupt("return");case 14:b(!1),T(!1);case 16:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),oe=function(){var e=p()(o.a.mark(function e(){var n,r;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return n={chain_id:~~z,source_id:t,chain:R,pid:q},X(!0),e.next=4,a({type:"Chain/updateChain",payload:d()({},n)});case 4:if(r=e.sent,X(!1),0!==r.code){e.next=11;break}le(),J(""),e.next=13;break;case 11:return l["a"].error({title:"\u9519\u8bef",content:JSON.stringify(r.message)}),e.abrupt("return");case 13:T(!1);case 14:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),ue=(e,t)=>{re(t),"add"==t?ee("\u65b0\u589e\u5b50\u94fe\u8def\u8282\u70b9"):(ee("\u4fee\u6539\u94fe\u8def\u8282\u70b9"),J(e.chain)),T(!N),B(e.chain_id),Q(e.pid)},de=e=>{l["a"].confirm({title:"\u786e\u5b9a\u8981\u5220\u9664\u94fe\u8def\u5417\uff1f",content:e.chain,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){var t=p()(o.a.mark(function t(){return o.a.wrap(function(t){while(1)switch(t.prev=t.next){case 0:a({type:"Chain/deleteChain",payload:{chain_id:~~e.chain_id}}).then(e=>{0===e.code&&le()}).catch(e=>{l["a"].error({title:"\u9519\u8bef",content:e})});case 1:case"end":return t.stop()}},t)}));function n(){return t.apply(this,arguments)}return n}(),onCancel:()=>{}})},he=()=>{R?"add"==ne?se():oe():l["a"].error({title:"\u9519\u8bef",content:"\u94fe\u8def\u672a\u586b\u5199"})};return Object(y["useEffect"])(()=>{le()},[]),E.a.createElement(E.a.Fragment,null,E.a.createElement(_,{chainDetailList:c,switchAddModal:(e,t)=>ue(e,t),deleteCurChain:e=>de(e)}),E.a.createElement(v["a"],{trigger:"click",content:ie,visible:h,onVisibleChange:()=>b(!h)},E.a.createElement(m["a"],{type:"primary",icon:"plus"},"\u540c\u7ea7")),E.a.createElement(l["a"],{title:$,destroyOnClose:!0,visible:N,confirmLoading:U,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:he,onCancel:()=>T(!N)},E.a.createElement(f["a"],{value:R,onChange:e=>J(e.target.value)})))},F=Object(w["c"])()(D),I=g["a"].Item,L=(e,t)=>{var a=e.form,n=a.getFieldDecorator,r=(a.setFieldsValue,{labelCol:{span:6},wrapperCol:{span:18}});return E.a.createElement(E.a.Fragment,null,E.a.createElement(g["a"],Object.assign({},r),E.a.createElement(I,{label:"source_label"},n("source_label",{rules:[{required:!0,message:"source_label\u5fc5\u586b"}]})(E.a.createElement(f["a"],null))),E.a.createElement(I,{label:"source_sign"},n("source_sign",{rules:[{required:!0,message:"source_sign\u5fc5\u586b"}]})(E.a.createElement(f["a"],null))),E.a.createElement(I,{label:"source_name"},n("source_name",{rules:[{required:!0,message:"source_name\u5fc5\u586b"}]})(E.a.createElement(f["a"],null)))))},N=g["a"].create()(L),T=g["a"].Item,A=(f["a"].Search,e=>{var t=e.dispatch,a=Object(y["useRef"])(),s=Object(y["useState"])([]),u=C()(s,2),h=(u[0],u[1],Object(y["useState"])()),b=C()(h,2),v=(b[0],b[1],Object(y["useState"])(0)),x=C()(v,2),k=x[0],w=x[1],O=Object(y["useState"])(!1),S=C()(O,2),_=S[0],j=S[1],D=Object(y["useState"])(!1),I=C()(D,2),L=I[0],A=I[1],M=Object(y["useState"])(),R=C()(M,2),J=R[0],P=R[1],V=Object(y["useState"])(!1),z=C()(V,2),B=z[0],H=z[1],K=Object(y["useState"])(!1),q=C()(K,2),Q=q[0],Z=q[1],G=Object(y["useState"])([]),U=C()(G,2),X=U[0],Y=U[1],W=[{key:"source_id",title:"\u5e8f\u53f7",dataIndex:"source_id",align:"center",width:100},{key:"source_label",title:"\u7ad9\u70b9",dataIndex:"source_label",align:"center"},{key:"chain_count",title:"\u94fe\u8def\u6570\u91cf",dataIndex:"chain_count",width:100,align:"center"},{title:"\u64cd\u4f5c",dataIndex:"Action",key:"Action",align:"center",width:"140",render:(e,t)=>{var a=E.a.createElement(m["a"],{type:"link",onClick:()=>re(t)},"\u7f16\u8f91"),n=E.a.createElement(m["a"],{type:"link",onClick:()=>ae(t)},"\u5220\u9664");return E.a.createElement(E.a.Fragment,null,a,n)}}],$=e=>{P(e.target.value.trim())},ee=()=>{P(""),ne()},te=function(){var e=p()(o.a.mark(function e(a){var n;return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return Z(!0),e.next=3,t({type:"Chain/createSource",payload:d()({},a)});case 3:n=e.sent,0===n.code&&(ne(),A(!L)),Z(!1);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),ae=e=>{l["a"].confirm({title:"\u786e\u8ba4\u5220\u9664\u7ad9\u70b9\u53ca\u94fe\u8def\u5417\uff1f",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){var a=p()(o.a.mark(function a(){return o.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:t({type:"Chain/deleteSource",payload:{source_id:~~e.source_id}}).then(e=>{0===e.code?ne():l["a"].error({title:"\u9519\u8bef",content:e.message})}).catch(e=>{l["a"].error({title:"\u9519\u8bef",content:e})});case 1:case"end":return a.stop()}},a)}));function n(){return a.apply(this,arguments)}return n}(),onCancel:()=>{}})},ne=function(){var e=p()(o.a.mark(function e(a){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:H(!0),t({type:"Chain/getSourceList",payload:{source_name:a}}).then(e=>{H(!1),0===e.code?Y([...e.data]):l["a"].error({title:"\u9519\u8bef",content:e.message})}).catch(e=>{H(!1),l["a"].error({title:"\u9519\u8bef",content:e})});case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),re=e=>{w(e.source_id),j(!_)},ce=()=>{a.current.validateFields(function(){var e=p()(o.a.mark(function e(t,a){return o.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,te(a);case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}())};return Object(y["useEffect"])(()=>{ne()},[]),E.a.createElement(E.a.Fragment,null,E.a.createElement("div",{className:"main-content"},E.a.createElement(i["a"],null,E.a.createElement(c["a"],{span:20},E.a.createElement(g["a"],{layout:"inline"},E.a.createElement(c["a"],{span:4},E.a.createElement(T,null,E.a.createElement(m["a"],{type:"primary",onClick:()=>A(!L)},"\u65b0\u5efa\u7ad9\u70b9"))),E.a.createElement(c["a"],{span:20},E.a.createElement(T,{label:"\u7ad9\u70b9\u540d\u79f0"},E.a.createElement(f["a"],{onChange:$,value:J})),E.a.createElement(T,null,E.a.createElement(m["a"],{type:"primary",style:{marginRight:"20px"},onClick:()=>ne(J)},"\u641c\u7d22"),E.a.createElement(m["a"],{type:"primary",onClick:ee},"\u91cd\u7f6e")))))),E.a.createElement("div",{style:{width:"600px"}},E.a.createElement(r["a"],{columns:W,dataSource:X,bordered:!0,rowKey:"source_id",loading:B})),E.a.createElement(n["a"],{title:"\u5934\u6761\u94fe\u8def\u7f16\u8f91",placement:"right",width:"80%",visible:_,onClose:()=>j(!_),destroyOnClose:!0},E.a.createElement(F,{source_id:~~k})),E.a.createElement(l["a"],{title:"\u65b0\u5efa\u3001\u4fee\u6539\u7ad9\u70b9",visible:L,confirmLoading:Q,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:ce,onCancel:()=>A(!L)},E.a.createElement(N,{ref:a}))))});t["default"]=Object(w["c"])()(A)},zH4S:function(e,t,a){e.exports={"chain-item":"chain-item"}}}]);