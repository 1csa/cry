(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[10],{"3UP/":function(e,a,t){e.exports={title:"title",back:"back","form-title":"form-title","label-title":"label-title","form-table":"form-table",cancel:"cancel",label:"label","upload-area":"upload-area"}},"9ZiI":function(e,a,t){"use strict";t.r(a);t("TPNu");var r=t("VogX"),i=(t("svhj"),t("aux4")),l=(t("LCbC"),t("NwOV")),n=(t("ljfu"),t("x2dm")),o=(t("vgpD"),t("UL5a")),s=(t("zAnB"),t("cUST")),c=(t("zI7Q"),t("SCaQ")),d=t("Z32k"),u=t.n(d),m=t("JGaj"),p=t.n(m),_=(t("IJu9"),t("DuHN")),y=t("JCfe"),f=t.n(y),g=t("maMK"),v=t.n(g),b=(t("oeo2"),t("BmDy")),w=t("ERkP"),h=t.n(w),E=t("n/bh"),k=t("73Ja"),I=t("uDfI"),x=e=>{for(var a=window.location.href,t=a.substring(a.indexOf("?")+1),r=t.split("&"),i=0;i<r.length;i++){var l=r[i].split("=");if(l[0]==e)return l[1]}return""},S=t("sy1d"),D=t("9wE7"),j=t.n(D),O=t("EUZL"),C=t.n(O),L=(t("3UP/"),b["a"].TextArea),N=e=>{var a=e.form,t=e.dispatch,d=e.user,m=Object(w["useState"])([]),y=v()(m,2),g=y[0],I=y[1],D=Object(w["useState"])(!1),O=v()(D,2),N=O[0],T=O[1],V=Object(w["useState"])([]),F=v()(V,2),q=F[0],U=F[1],G=Object(w["useState"])(x("type")),P=v()(G,2),R=P[0],A=P[1],J=Object(w["useState"])(!1),z=v()(J,2),B=z[0],M=z[1],Z=Object(w["useState"])(""),H=v()(Z,2),K=H[0],Q=H[1],X=Object(w["useState"])(!1),$=v()(X,2),W=$[0],Y=$[1],ee=Object(w["useState"])([]),ae=v()(ee,2),te=ae[0],re=ae[1],ie=Object(w["useState"])([]),le=v()(ie,2),ne=le[0],oe=le[1],se={create_author:"",task_name:"",task_id:"",task_remarks:"",delivery_way:1,account_way:2,running_way:1,platform_store:1,delivery_config:"edit"===R||"scan"===R?[]:[{source_id:1}],posting_time:2,filter_word:"",filter_account:"",import_account:1,import_relationship:2,account_address:"",export_app:1,export_bucket:""},ce=Object(w["useState"])(se),de=v()(ce,2),ue=de[0],me=de[1],pe=a.getFieldDecorator,_e=e=>{ue.delivery_way=e,2===ue.delivery_way?(ue.account_way=1,ue.posting_time=1,ue.platform_store=1,ue.delivery_config=[{source_id:1}],E["I"][1].disabled=!0):(ue.delivery_config=K?te:[{source_id:1}],ue.account_way=2,ue.posting_time=2,K||(ue.import_relationship=1),E["I"][1].disabled=!1),ue.running_way=1,me(f()({},ue))},ye=e=>{ue.account_way=e.target.value,1===ue.account_way?(ue.import_relationship=1,E["D"][0].disabled=!1):(ue.import_relationship=2,E["D"][0].disabled=!0),me(f()({},ue))},fe=e=>{ue.import_relationship=e.target.value,me(f()({},ue))},ge=e=>{ue.running_way=e.target.value,1===e.target.value?E["D"][0].disabled=!0:E["D"][0].disabled=!1,me(f()({},ue))},ve=e=>{ue.platform_store=e.target.value,me(f()({},ue))},be=(e,a)=>{ue.delivery_config[a-1]["platform_type_id"]=e,me(f()({},ue))},we=(e,a)=>{ue.delivery_config[a-1]["source_id"]=e,me(f()({},ue))},he=(e,a)=>{ue.delivery_config[a-1]["score"]=e,me(f()({},ue))},Ee=(e,a)=>{ue.delivery_config[a-1]["count_all"]=e,me(f()({},ue))},ke=(e,a)=>{ue.delivery_config[a-1]["category_id"]=e,me(f()({},ue))},Ie=(e,a)=>{ue.delivery_config[a-1]["hot_type"]=e,me(f()({},ue))},xe=e=>{ue.export_app=e},Se=()=>{if(W){var e=new FormData;g.forEach(a=>{e.append("excel",a)}),T(!0);var a=1===ue.import_relationship?E["G"].uploadOneToOneFile:E["G"].uploadRandomFile;S["a"].post(a,{data:e}).then(e=>{0===e.code&&(T(!1),ue.account_address=e.data.redis_key,me(f()({},ue)),_["a"].success("\u4e0a\u4f20\u6210\u529f"))})}},De=function(){var e=p()(u.a.mark(function e(){var a,r,i,l,n;return u.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t({type:"putTaskList/getSiteList"});case 2:a=e.sent,r=a.code,i=a.message,l=a.data,n=void 0===l?{}:l,0===r||"success"===i?U([...n.sources||[]]):(U([...[]]),_["a"].error("".concat(i)));case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),je=function(){var e=p()(u.a.mark(function e(){var a,r,i,l,n;return u.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t({type:"putTaskList/getExportAppList"});case 2:a=e.sent,r=a.code,i=a.message,l=a.data,n=void 0===l?{}:l,0===r||"success"===i?oe([...n.export_apps||[]]):(oe([...[]]),_["a"].error("".concat(i)));case 8:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}();Object(w["useEffect"])(()=>{var e=x("id");Q(e),""!==e&&Oe(e),e||(ue.import_relationship=1),De();var a=x("type");A(a),M("scan"===a),je(),1===ue.delivery_way?E["D"][0].disabled=!1:1===ue.account_way?E["D"][0].disabled=!1:E["D"][0].disabled=!0},[]);var Oe=function(){var e=p()(u.a.mark(function e(a){var r,i,l,n,o;return u.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t({type:"putTaskList/getTaskDetail",payload:{id:a}});case 2:r=e.sent,i=r.code,l=r.message,n=r.data,o=void 0===n?[]:n,0!==i&&"success"!==l||("copy"===R&&delete o.task.account_address,re([...o.task.delivery_config]),o.task.filter_account=o.task.filter_account.join(","),o.task.filter_word=o.task.filter_word.join(","),me(f()({},o.task)),o.task.account_address&&I([{uid:"-1",name:"".concat(o.task.account_address.split("_")[1]),status:"done",url:""}]));case 8:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}(),Ce=()=>{ue.delivery_config.length<5?(ue.delivery_config.push({source_id:1,score:70}),me(f()({},ue))):_["a"].error("\u914d\u7f6e\u4fe1\u606f\u53ea\u80fd\u6dfb\u52a0\u4e94\u6761")},Le=e=>{ue.delivery_config.splice(e-1,1),me(f()({},ue))},Ne=()=>{j.a.go(-1)},Te=()=>{var e=1===ue.import_relationship?[["\u83b7\u53d6\u8d26\u53f7\u540d\u79f0","\u83b7\u53d6\u8d26\u53f7\u4e3b\u9875URL","median ID","\u8d26\u53f7\u540d\u79f0","\u9886\u57df","\u6765\u6e90"]]:2===ue.delivery_way&&1===ue.account_way?[["\u83b7\u53d6\u8d26\u53f7\u540d\u79f0","\u83b7\u53d6\u8d26\u53f7\u4e3b\u9875URL","median ID","\u8d26\u53f7\u540d\u79f0","\u9886\u57df","\u6765\u6e90"]]:[["median ID","\u8d26\u53f7\u540d\u79f0","\u9886\u57df"]],a=C.a.utils.aoa_to_sheet(e),t=C.a.utils.book_new();C.a.utils.book_append_sheet(t,a,"SheetJS");var r=1===ue.import_relationship?"\u4e00\u4e00\u5bf9\u5e94\u6a21\u677f.xlsx":"\u968f\u673a\u6253\u6563\u6a21\u677f.xlsx";C.a.writeFile(t,r)},Ve=()=>{a.validateFields(function(){var e=p()(u.a.mark(function e(a,r){var i,l,n,o,s,c,m,p,y,g,v,b;return u.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:if(!a){e.next=2;break}return e.abrupt("return");case 2:if(i=ue.delivery_config,1===r["delivery_way"]?i.forEach(e=>{1===r["platform_store"]&&(e["category_id"]=1),1===r["platform_store"]?delete e.hot_type:delete e.score}):i.forEach(e=>{e.domain_id=0}),ue.delivery_config=[...i],r["delivery_config"]=ue.delivery_config,r["account_address"]=ue.account_address,l=/^([\u0391-\uFFE5\d\w,])*([\u0391-\uFFE5\d\w]+)$/,r["filter_word"]&&r["filter_word"].match(l)&&r["filter_word"].match(l).length>0?(n=r["filter_word"].replace(/\uff0c/gi,","),r["filter_word"]=n.split(",")):r["filter_word"]&&_["a"].error("\u8bf7\u8f93\u5165\u4ee5\u9017\u53f7\u9694\u5f00\u7684\u5173\u952e\u8bcd"),r["filter_account"]&&r["filter_account"].match(l)&&r["filter_account"].match(l).length>0?(o=r["filter_account"].replace(/\uff0c/gi,","),r["filter_account"]=o.split(",")):r["filter_account"]&&_["a"].error("\u8bf7\u8f93\u5165\u4ee5\u9017\u53f7\u9694\u5f00\u7684\u8d26\u53f7"),s=d.currentUser,c=void 0===s?{}:s,2===r["delivery_way"]&&1===r["account_way"]&&delete r["delivery_config"],""==r["filter_account"]&&(r["filter_account"]=[]),""==r["filter_word"]&&(r["filter_word"]=[]),"edit"!==R){e.next=26;break}return r["operators"]=c.name,r["job_id"]=K,e.next=19,t({type:"putTaskList/editTask",payload:f()({jobId:K},r)});case 19:m=e.sent,p=m.code,y=m.errors,m.data,0===p?(_["a"].success("\u7f16\u8f91\u6210\u529f"),j.a.go(-1)):_["a"].error(y),e.next=36;break;case 26:if(R&&"copy"!==R){e.next=36;break}return r["create_author"]=c.name,r["email_address"]=c.email,e.next=31,t({type:"putTaskList/createTask",payload:f()({},r)});case 31:g=e.sent,v=g.code,b=g.message,g.data,0===v?(_["a"].success("\u4fdd\u5b58\u6210\u529f"),j.a.go(-1)):_["a"].error("string"===typeof b?b:b[0].msg);case 36:case"end":return e.stop()}},e)}));return function(a,t){return e.apply(this,arguments)}}())},Fe={accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",beforeUpload:e=>{if(e.size/1048576>2)return _["a"].error("\u6587\u4ef6\u5927\u5c0f\u4e0d\u80fd\u8d85\u8fc72M!"),void Y(!1);var a=new FileReader;a.onload=(e=>{try{var a=e.target?e.target.result:{},t=C.a.read(a,{type:"binary"}),r=[];for(var i in t.Sheets)t.Sheets.hasOwnProperty(i)&&(r=r.concat(C.a.utils.sheet_to_json(t.Sheets[i])));var l=Object.keys(r[0]);if(1===ue.import_relationship){if(l.toString()!==["\u83b7\u53d6\u8d26\u53f7\u540d\u79f0","\u83b7\u53d6\u8d26\u53f7\u4e3b\u9875URL","median ID","\u8d26\u53f7\u540d\u79f0","\u9886\u57df","\u6765\u6e90"].toString())return _["a"].error('\u5b57\u6bb5\u540d\u79f0\u5e94\u4e3a"\u83b7\u53d6\u8d26\u53f7\u540d\u79f0", "\u83b7\u53d6\u8d26\u53f7\u4e3b\u9875URL", "median ID", "\u8d26\u53f7\u540d\u79f0", "\u9886\u57df", "\u6765\u6e90"'),void Y(!1);Y(!0)}else{if(1==ue.delivery_way&&l.toString()!==["median ID","\u8d26\u53f7\u540d\u79f0","\u9886\u57df"].toString())return _["a"].error('\u5b57\u6bb5\u540d\u79f0\u5e94\u4e3a"median ID", "\u8d26\u53f7\u540d\u79f0", "\u9886\u57df"'),void Y(!1);if(2==ue.delivery_way&&1==ue.account_way&&l.toString()!==["\u83b7\u53d6\u8d26\u53f7\u540d\u79f0","\u83b7\u53d6\u8d26\u53f7\u4e3b\u9875URL","median ID","\u8d26\u53f7\u540d\u79f0","\u9886\u57df","\u6765\u6e90"].toString())return _["a"].error('\u5b57\u6bb5\u540d\u79f0\u5e94\u4e3a"\u83b7\u53d6\u8d26\u53f7\u540d\u79f0", "\u83b7\u53d6\u8d26\u53f7\u4e3b\u9875URL", "median ID", "\u8d26\u53f7\u540d\u79f0", "\u9886\u57df", "\u6765\u6e90"'),void Y(!1);if(1==ue.delivery_way&&2==ue.account_way&&l.toString()!==["median ID","\u8d26\u53f7\u540d\u79f0","\u9886\u57df"].toString())return _["a"].error('\u5b57\u6bb5\u540d\u79f0\u5e94\u4e3a"median ID", "\u8d26\u53f7\u540d\u79f0", "\u9886\u57df"'),void Y(!1);Y(!0)}}catch(e){return}}),a.readAsBinaryString(e),I([...g,e])},onRemove:e=>{var a=[...g];a.splice(a.findIndex(a=>a.uid===e.uid),1),I([...a])}},qe={width:1e3};return h.a.createElement("div",{className:"main-content"},h.a.createElement("p",{className:"title"},"scan"===R?"\u67e5\u770b\u4efb\u52a1":"edit"===R?"\u7f16\u8f91\u4efb\u52a1":"\u65b0\u5efa\u4efb\u52a1",h.a.createElement(c["a"],{onClick:Ne,className:"back",type:"link"},"\u8fd4\u56de")),h.a.createElement(s["a"],null),h.a.createElement(o["a"],Object.assign({},qe,{onSubmit:Ve}),h.a.createElement("div",{className:"form-title"},"\u4efb\u52a1\u5185\u5bb9"),ue.task_id&&"copy"!==R?h.a.createElement("span",{className:"label"},"\u4efb\u52a1ID:\xa0\xa0",ue.task_id):h.a.createElement(h.a.Fragment,null),h.a.createElement(o["a"].Item,{label:"\u4efb\u52a1\u540d\u79f0"},pe("task_name",{initialValue:ue.task_name,rules:[{required:!0,min:1,max:25,message:"\u5fc5\u586b\u9879\u4e14\u6700\u957f\u53ef\u8f93\u516525\u4f4d"}]})(h.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165\u4efb\u52a1\u540d\u79f0",style:qe,disabled:B}))),h.a.createElement(o["a"].Item,{label:"\u4efb\u52a1\u8bf4\u660e"},pe("task_remarks",{initialValue:ue.task_remarks,rules:[{required:!0,min:1,max:200,message:"\u5fc5\u586b\u9879\u4e14\u6700\u957f\u53ef\u8f93\u5165200\u4f4d"}]})(h.a.createElement(b["a"],{placeholder:"\u8bf7\u8f93\u5165\u4efb\u52a1\u8bf4\u660e",style:qe,disabled:B}))),h.a.createElement(o["a"].Item,{label:"\u4efb\u52a1\u65b9\u5f0f"},pe("delivery_way",{initialValue:ue.delivery_way,rules:[{required:!0}]})(h.a.createElement(n["a"],{placeholder:"\u8bf7\u9009\u62e9\u4efb\u52a1\u65b9\u5f0f",onChange:_e,style:qe,disabled:B},E["M"].map((e,a)=>{return h.a.createElement(n["a"].Option,{value:e.delivery_way,key:a},e.label)})))),h.a.createElement(o["a"].Item,{label:"\u4efb\u52a1\u65f6\u95f4"},pe("running_way",{initialValue:ue.running_way,rules:[{required:!0}]})(h.a.createElement(l["a"].Group,{options:E["I"],onChange:ge,disabled:B}))),h.a.createElement("div",{className:"form-title"},"\u5185\u5bb9\u7b5b\u9009"),1===ue.delivery_way?h.a.createElement(o["a"].Item,{label:"\u5185\u5bb9\u5e93"},pe("platform_store",{initialValue:ue.platform_store,rules:[{required:!0}]})(h.a.createElement(l["a"].Group,{options:E["E"],disabled:B,onChange:ve}))):h.a.createElement(o["a"].Item,{label:"\u5185\u5bb9\u5e93"},pe("platform_store",{initialValue:ue.platform_store,rules:[{required:!0}]})(h.a.createElement(l["a"].Group,{options:E["x"],disabled:B,onChange:ve}))),2===ue.delivery_way?h.a.createElement(o["a"].Item,{label:"\u8d26\u53f7\u8bbe\u7f6e"},pe("account_way",{initialValue:ue.account_way,rules:[{required:!0}]})(h.a.createElement(l["a"].Group,{options:E["z"],disabled:B,onChange:ye}))):h.a.createElement(h.a.Fragment,null),1===ue.delivery_way?h.a.createElement(o["a"].Item,{label:"\u5185\u5bb9\u7b5b\u9009\u65f6\u95f4"},pe("posting_time",{initialValue:ue.posting_time,rules:[{required:!0}]})(h.a.createElement(l["a"].Group,{options:E["N"],disabled:B}))):h.a.createElement(o["a"].Item,{label:"\u53d1\u6587\u65f6\u95f4"},pe("posting_time",{initialValue:ue.posting_time,rules:[{required:!0}]})(h.a.createElement(l["a"].Group,{options:E["K"],disabled:B}))),1===ue.delivery_way?h.a.createElement("p",{className:"label-title"},"\u5185\u5bb9\u91cf\u8bbe\u7f6e:"):h.a.createElement(h.a.Fragment,null),1!==ue.account_way&&ue.delivery_config.map((e,a)=>{return h.a.createElement(k["default"],{index:a+1,siteList:q,item:e,type:R,taskType:ue.delivery_way,platForm:ue.platform_store,key:"item".concat(a+1),deleteItem:Le,selectSiteType:we,selectContentType:be,changeContentScore:he,selectHotType:Ie,selectCategory:ke,changeCountAll:Ee})}),1!==ue.account_way&&h.a.createElement(o["a"].Item,{className:"add-btn"},h.a.createElement(c["a"],{type:"primary",disabled:B,onClick:Ce},"\u65b0\u589e")),h.a.createElement("div",{className:"form-title"},"\u8fc7\u6ee4\u5185\u5bb9"),h.a.createElement(o["a"].Item,{label:"\u8fc7\u6ee4\u4ee5\u4e0b\u5173\u952e\u8bcd"},pe("filter_word",{initialValue:ue.filter_word})(h.a.createElement(L,{placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd,\u7528\u9017\u53f7\u9694\u5f00",rows:4,style:qe,disabled:B}))),h.a.createElement(o["a"].Item,{label:"\u8fc7\u6ee4\u4ee5\u4e0b\u8d26\u53f7"},pe("filter_account",{initialValue:ue.filter_account})(h.a.createElement(L,{placeholder:"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd,\u7528\u9017\u53f7\u9694\u5f00",rows:4,style:qe,disabled:B}))),h.a.createElement("div",{className:"form-title"},"\u5bfc\u5165\u8d26\u53f7"),h.a.createElement(o["a"].Item,{label:"\u5bfc\u5165\u8d26\u53f7"},pe("import_account",{initialValue:ue.import_account,rules:[{required:!0}]})(h.a.createElement(l["a"].Group,{options:E["y"],disabled:B}))),h.a.createElement(o["a"].Item,{label:"\u5bfc\u5165\u5173\u7cfb"},pe("import_relationship",{initialValue:ue.import_relationship,rules:[{required:!0}]})(h.a.createElement(l["a"].Group,{options:E["D"],disabled:B,onChange:fe}))),h.a.createElement(o["a"].Item,{label:"\u8d26\u53f7\u8868",className:"form-table"},pe("account_address",{initialValue:ue.account_address,rules:[{required:!0,message:"\u8d26\u53f7\u8868\u4e0d\u80fd\u4e3a\u7a7a"}]})(h.a.createElement("div",{className:"upload-area"},h.a.createElement(i["a"],Object.assign({},Fe,{fileList:g}),h.a.createElement(c["a"],{disabled:B},h.a.createElement(r["a"],{type:"upload"})," \u9009\u62e9\u6587\u4ef6")),h.a.createElement(c["a"],{type:"primary",onClick:Se,disabled:!W,loading:N,style:{marginLeft:10,marginTop:4}},N?"\u4e0a\u4f20\u4e2d...":"\u5f00\u59cb\u4e0a\u4f20"),h.a.createElement(c["a"],{type:"link",onClick:Te,style:{marginLeft:10,marginTop:4}},"\u4e0b\u8f7d\u6a21\u677f")))),h.a.createElement("div",{className:"form-title"},"\u8f93\u51fa\u65b9"),h.a.createElement(o["a"].Item,{label:"\u8f93\u51faAPP"},pe("export_app",{initialValue:ue.export_app,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u8f93\u51faAPP"}]})(h.a.createElement(n["a"],{placeholder:"\u8bf7\u9009\u62e9\u8f93\u51faAPP",onChange:xe,style:qe,disabled:B},ne.map((e,a)=>{return h.a.createElement(n["a"].Option,{value:e.export_app_id,key:a},e.export_app_name)})))),h.a.createElement(o["a"].Item,{className:"wrap"},h.a.createElement("div",{className:"wrap-bottom"},h.a.createElement(c["a"],{type:"primary",onClick:Ve,disabled:B},"edit"===R?"\u4fee\u6539":"\u4fdd\u5b58"),h.a.createElement(c["a"],{onClick:Ne,className:"cancel"},"\u53d6\u6d88")))))};a["default"]=Object(I["c"])(e=>{var a=e.user;return{user:a}})(o["a"].create()(N))}}]);