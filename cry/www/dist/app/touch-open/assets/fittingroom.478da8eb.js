import{d as W,c as X,y as Z,z as ee,l as D,G as te,a as F,b as o,w as a,H as ae,a3 as oe,a4 as se,a5 as B,p as E,a6 as O,r as u,o as _,F as S,B as ne,e as f,f as v,a7 as ie,h as y,i as c,t as $,a8 as re,A as ue,a9 as le,aa as de,ab as _e,ac as me,ad as ce,J as pe,E as fe,k as ge}from"./index.2bba2224.js";const ve=c("\u66F4\u65B0"),ye=c("\u53D6\u6D88"),Fe=c("\u589E\u52A0"),be=c("\u5220\u9664"),he={name:"ShopFittingroom"},Re=W({...he,setup(Ie){const A=X(()=>[{title:"\u8BD5\u8863\u95F4\u5E8F\u53F7",dataIndex:"room_id",key:"room_id",align:"center"},{title:"\u8BD5\u8863\u95F4\u72B6\u6001",dataIndex:"status",key:"status",align:"center",customRender:({text:t,record:e})=>e.migrate_room_id==0?re(t):`\u8FC1\u79FB-${e.migrate_room_id}`},{title:"\u8BD5\u8863\u95F4\u7528\u9014",dataIndex:"category",key:"category",align:"center"},{title:"\u8BD5\u8863\u95F4\u64CD\u4F5C",dataIndex:"operation",align:"center"}]),b="HH:mm:ss",H=Z.useForm,h=oe(),{modelRef:g,rulesRef:T}=ee(h),{resetFields:M,validate:N,validateInfos:U}=H(g,T),l=D({shopId:null}),R=te([]),j=t=>{l.shopId=t,d()},d=async()=>{const t=await se({shop_id:l.shopId}),{list:e,reserve_info:r}=t.result;R.value=e,r.reserve_time=[B(r.start_reserve_time,"HH:mm:ss"),B(r.end_reserve_time,"HH:mm:ss")],Object.assign(g,r)},I=async t=>{if(t==="submit"){await N();const e=ue(g);e.start_reserve_time=e.reserve_time&&e.reserve_time[0].format(b),e.end_reserve_time=e.reserve_time&&e.reserve_time[1].format(b),e.shop_id=l.shopId,delete e.reserve_time,await le(e),E.success("\u66F4\u65B0\u6210\u529F!"),d()}t==="cancel"&&(M(),d())},C=async t=>{let e={shop_id:l.shopId,count:1};t==="add"&&await de(e),t==="del"&&await _e(e),d()},L=async(t,e)=>{let r={shop_id:l.shopId,room_id:e.room_id,op_type:t};await me(r)},V=async t=>{let e={shop_id:l.shopId,room_id:t.room_id,op_type:t.status==0?2:1};await ce(e),d()},i=D({visible:!1,currentRow:{}}),z=async t=>{if(t.migrate_room_id==0){i.visible=!0,i.currentRow=pe.exports.cloneDeep(t),i.currentRow.migrate_room_id="";return}let e={shop_id:l.shopId,room_id:t.room_id,op_type:2};await O(e),d()},G=async()=>{if(!i.currentRow.migrate_room_id){E.error("\u76EE\u6807\u8BD5\u8863\u95F4\u7F16\u53F7\u4E0D\u80FD\u4E3A\u7A7A\uFF01");return}let t={shop_id:l.shopId,room_id:i.currentRow.room_id,target_room_id:Number(i.currentRow.migrate_room_id),op_type:1};await O(t),i.visible=!1,d()};return(t,e)=>{const r=u("a-col"),m=u("a-button"),w=u("a-space"),P=u("a-form-item"),k=u("a-row"),J=u("a-form"),x=u("a-card"),K=u("a-select"),Y=u("a-table"),q=u("a-input"),Q=u("a-modal");return _(),F("div",null,[o(ae,{fixed:!0,onChange:j},{search:a(()=>[o(x,{class:"search-box"},{default:a(()=>[o(J,{ref:"searchFormRef",layout:"inline"},{default:a(()=>[o(k,{gutter:[24,16]},{default:a(()=>[(_(!0),F(S,null,ne(f(h),(s,n)=>(_(),v(r,{key:n},{default:a(()=>[o(fe,{field:s,modelRef:f(g),fieldkey:n,validateInfos:f(U)},null,8,["field","modelRef","fieldkey","validateInfos"])]),_:2},1024))),128)),o(r,{style:{"text-align":"right"}},{default:a(()=>[o(P,null,{default:a(()=>[o(w,{size:20},{default:a(()=>[o(m,{type:"primary",onClick:e[0]||(e[0]=s=>I("submit"))},{default:a(()=>[ve]),_:1}),o(m,{onClick:e[1]||(e[1]=s=>I("cancel"))},{default:a(()=>[ye]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},512)]),_:1})]),main:a(()=>[o(x,{class:"table-box mt20"},{default:a(()=>[o(k,{class:"action-btn-box",justify:"space-between"},{default:a(()=>[o(r),o(r,null,{default:a(()=>[o(w,null,{default:a(()=>[o(m,{type:"primary",onClick:e[2]||(e[2]=s=>C("add"))},{default:a(()=>[Fe]),_:1}),o(m,{type:"danger",ghost:"",onClick:e[3]||(e[3]=s=>C("del"))},{default:a(()=>[be]),_:1})]),_:1})]),_:1})]),_:1}),o(Y,{rowKey:"room_id",columns:f(A),"data-source":R.value,pagination:null,bordered:""},{bodyCell:a(({column:s,record:n})=>[s.dataIndex==="category"?(_(),v(K,{key:0,value:n[s.dataIndex],"onUpdate:value":p=>n[s.dataIndex]=p,bordered:!1,options:f(ie),disabled:n.status==1,onChange:p=>L(p,n)},null,8,["value","onUpdate:value","options","disabled","onChange"])):y("",!0),s.dataIndex==="operation"?(_(),F(S,{key:1},[n.category==2?(_(),v(m,{key:0,type:"link",class:"action-btn",onClick:p=>V(n)},{default:a(()=>[c($(n.status==0?"\u542F\u7528":"\u505C\u7528"),1)]),_:2},1032,["onClick"])):y("",!0),n.category==1?(_(),v(m,{key:1,type:"link",class:"action-btn",onClick:p=>z(n)},{default:a(()=>[c($(n.migrate_room_id==0?"\u8FC1\u79FB":"\u6062\u590D"),1)]),_:2},1032,["onClick"])):y("",!0)],64)):y("",!0)]),_:1},8,["columns","data-source"])]),_:1})]),_:1}),o(Q,{visible:i.visible,"onUpdate:visible":e[5]||(e[5]=s=>i.visible=s),title:"\u8FC1\u79FB\u8BD5\u8863\u95F4",onOk:G,width:"300px"},{default:a(()=>[o(q,{type:"number",value:i.currentRow.migrate_room_id,"onUpdate:value":e[4]||(e[4]=s=>i.currentRow.migrate_room_id=s),valueModifiers:{trim:!0}},null,8,["value"])]),_:1},8,["visible"])])}}});const we=ge(Re,[["__scopeId","data-v-8f86245d"]]);export{we as default};
