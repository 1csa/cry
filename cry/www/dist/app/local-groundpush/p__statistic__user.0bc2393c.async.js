(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[7],{CrW3:function(e,a,t){"use strict";t.r(a);t("YdMF");var s=t("dVZ9"),c=(t("zI7Q"),t("SCaQ")),l=(t("IJu9"),t("DuHN")),r=t("JCfe"),n=t.n(r),o=t("maMK"),i=t.n(o),d=t("ERkP"),m=t.n(d),u=t("uDfI"),b=t("wgY5"),p=t.n(b),h=t("7cJT"),f=t("jGgj"),v=t("N+uz"),O=t("fcGt"),S=(t("y0tC"),[{name:"\u56e2\u961f",value:"teamIds"},{name:"\u5730\u63a8\u5458",value:"pushManIds"},{name:"\u7528\u6237uid",value:"userIds"}]),g=e=>{var a=e.others,t=e.dispatch,r=a.allTeams,o=a.allPushers,u=localStorage.getItem("userStatisticScreen"),b=u?JSON.parse(u).basicScreen:{limit:10,offset:0},g=u?JSON.parse(u).screenType:"teamIds",j=u?JSON.parse(u).queryValue:void 0,C=u?JSON.parse(u).defaultDate:7,E=Object(O["f"])(Date.now()-24*C*3600*1e3),I=Object(O["f"])(Date.now()-864e5),N=Object(v["a"])("/userInfo/list"),y=N.data,w=N.fetchData,T=Object(v["a"])("/userInfo/list"),k=T.data,D=T.fetchData,z=Object(d["useState"])(g),J=i()(z,2),Y=J[0],M=J[1],V=Object(d["useState"])([]),K=i()(V,2),P=K[0],A=K[1],Q=Object(d["useState"])(b),q=i()(Q,2),F=q[0],G=q[1],H=Object(d["useState"])(!1),R=i()(H,2),U=R[0],W=R[1],Z=Object(d["useState"])(j),x=i()(Z,2),B=x[0],L=x[1],X=Object(d["useState"])(C),$=i()(X,2),_=$[0],ee=$[1],ae=Object(d["useState"])(E),te=i()(ae,2),se=te[0],ce=te[1],le=Object(d["useState"])(I),re=i()(le,2),ne=re[0],oe=re[1];Object(d["useEffect"])(()=>{r&&0!==r.length||t({type:"others/fetchAllTeams"}),o&&0!==o.length||t({type:"others/fetchAllPushers"}),w(n()({},F,{startTime:se,endTime:ne,[Y]:B}))},[]),Object(d["useEffect"])(()=>{if(r&&o){var e=r,a=o.map(e=>{var a=e.id,t=e.name,s=e.phone;return{value:a,title:"".concat(t,"-").concat(a,"-").concat(s)}});switch(Y){case"pushManIds":A(a);break;case"teamIds":default:A(e)}}},[Y,r,o]),Object(d["useEffect"])(()=>{U&&D(n()({},F,{startTime:se,endTime:ne,offset:0,limit:999999,[Y]:B}))},[U]),Object(d["useEffect"])(()=>{if(U)try{Object(O["b"])(k&&k.list,"\u7528\u6237\u8be6\u60c5\u6570\u636e",be)}catch(e){l["a"].error("\u51fa\u9519\u4e86\u3002\u3002"),console.log(e,"error happened in downloading....")}finally{W(!1)}},[k]);var ie=Object(d["useCallback"])(e=>{L(void 0),M(e)},[]),de=Object(d["useCallback"])(()=>{w(n()({},F,{startTime:se,endTime:ne,[Y]:B}))},[F,Y,B,se,ne]),me=Object(d["useCallback"])((e,a)=>{ce(e&&e.format("YYYY-MM-DD")),oe(a&&a.format("YYYY-MM-DD"))},[]),ue=Object(d["useCallback"])((e,a,t)=>{var s=e.current,c=void 0===s?1:s,l=e.pageSize,r=void 0===l?10:l,o=t.order,i={limit:r,offset:r*(c-1),desc:"ascend"===o?"asc":void 0};w(n()({},i,{startTime:se,endTime:ne,[Y]:B})),G(i)},[F,se,ne,Y,B]),be=Object(d["useCallback"])(e=>{var a=e.timeKey,t=e.teamName,s=e.teamId,c=e.userId,l=e.appVersion,r=void 0===l?"--":l,n=e.os,o=void 0===n?"--":n,d=e.city,m=void 0===d?"--":d,u=e.lat,b=void 0===u?"--":u,p=e.lng,h=void 0===p?"--":p,v=e.activationTime,O=void 0===v?"--":v,S={timeKey:a,teamName:t,teamId:s,userId:c,appVersion:r,activationTime:O,os:0===o?"IOS":"Android",activationPlace:"".concat(m," ").concat(b," ").concat(h)},g=Object.entries(S).map(e=>{var a=i()(e,2),t=a[0],s=a[1];return[f["c"][t],s]});return Object.fromEntries(g)},[]),pe=Object(d["useCallback"])(()=>{localStorage.setItem("userStatisticScreen",JSON.stringify({basicScreen:F,screenType:Y,queryValue:B,defaultDate:_})),l["a"].success("\u4fee\u6539\u6210\u529f")},[F,se,ne,Y,B,_]);return m.a.createElement("div",{className:"board"},m.a.createElement("div",{className:"board-screen"},m.a.createElement("label",null,"\u65e5\u671f"),m.a.createElement(h["d"],{onSelectChange:me,onFastsetChange:ee,value:[p()(se),p()(ne)],fastSet:!0,tipContent:"\u4e0d\u542b\u5f53\u5929\u6570\u636e",defaultDate:_})),m.a.createElement("div",{className:"board-screen"},m.a.createElement("label",{className:"board-screen-label"},"\u7b5b\u9009"),m.a.createElement(h["c"],{size:"small",value:Y,radioOptions:S,onChange:e=>ie(e.target.value)}),{teamIds:m.a.createElement(h["e"],{className:"board-screen-select",mode:"multiple",filter:!0,value:B,options:P,placeholder:"\u8bf7\u9009\u62e9\u56e2\u961f",onChange:e=>L(e&&0!==e.length?e:void 0)}),pushManIds:m.a.createElement(h["e"],{className:"board-screen-select board-screen-select-pusher",mode:"multiple",filter:!0,value:B,options:P,placeholder:"\u8bf7\u9009\u62e9\u5730\u63a8\u5458(name-id-phone)",onChange:e=>L(e&&0!==e.length?e:void 0)}),userIds:m.a.createElement(h["f"],{className:"board-screen-input",tagTip:"\u8bf7\u8f93\u5165\u7528\u6237UID",tags:B,onChange:e=>L(e&&0!==e.length?e:void 0)})}[Y],m.a.createElement(c["a"],{size:"small",type:"primary",onClick:de},"\u67e5\u8be2"),m.a.createElement(c["a"],{size:"small",onClick:pe},"\u4fdd\u5b58\u7b5b\u9009\u53c2\u6570")),m.a.createElement("div",{className:"board-chart"},m.a.createElement("div",{className:"board-chart-operation"},m.a.createElement("div",null)," ",m.a.createElement(c["a"],{className:"board-chart-operation-download",icon:"download",size:"small",type:"primary",onClick:()=>W(!0)},"\u4e0b\u8f7dCSV")),m.a.createElement(s["a"],{className:"board-chart-table",columns:f["d"],dataSource:y&&y.list||[],rowKey:"userId",bordered:!0,onChange:ue,pagination:{size:"small",total:y&&y.total,pageSize:y&&y.pageSize,showQuickJumper:!0,showSizeChanger:!0,showTotal:e=>"\u603b\u8ba1".concat(e,"\u6761\u7ed3\u679c")}})))},j=Object(d["memo"])(g);a["default"]=Object(u["c"])(e=>({others:e.others}))(j)}}]);