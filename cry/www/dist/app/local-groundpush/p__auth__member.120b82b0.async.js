(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"/J1E":function(e,a,t){e.exports={add_content:"add_content",add_btn:"add_btn",query_param:"query_param",staff_query:"staff_query",team_attribute:"team_attribute",team:"team",staff:"staff",label:"label",search:"search","memberAuth-operation":"memberAuth-operation"}},AayX:function(e,a,t){"use strict";t.r(a);var n=t("Z32k"),l=t.n(n),r=(t("oj2R"),t("/zI6")),s=(t("YdMF"),t("dVZ9")),m=(t("oeo2"),t("BmDy")),i=t("JGaj"),c=t.n(i),o=(t("IJu9"),t("DuHN")),u=t("maMK"),d=t.n(u),p=(t("zI7Q"),t("SCaQ")),h=t("ERkP"),f=t.n(h),b=t("wgY5"),E=t.n(b),v=t("7cJT"),y=(t("Iaxd"),t("i6l0")),I=(t("vgpD"),t("UL5a")),g=(t("ljfu"),t("x2dm")),w=t("N+uz"),O=g["a"].Option,j=e=>{var a=e.visible,t=e.teamData,n=e.user.currentUser,s=void 0===n?{}:n,i=Object(w["a"])("/pushMan/createPushMan"),u=i.fetchData,d=e.form,p=d.getFieldDecorator,b=d.getFieldValue;function E(){return v.apply(this,arguments)}function v(){return v=c()(l.a.mark(function a(){var n;return l.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:n=b("wx"),e.form.validateFields(["teamId","name","phone","startTime","uid"],function(){var e=c()(l.a.mark(function e(a,r){return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:a||(r["updateUser"]=s.name,r["wx"]=n,r["startTime"]=r.startTime.format("YYYY-MM-DD HH:mm:ss"),t&&t.forEach(e=>{e.value==r.teamId&&(r["teamName"]=e.title)}),u(r,j));case 1:case"end":return e.stop()}},e)}));return function(a,t){return e.apply(this,arguments)}}());case 2:case"end":return a.stop()}},a)})),v.apply(this,arguments)}var j=Object(h["useCallback"])(()=>{e.onAddMember(),o["a"].success("\u6210\u5458\u6dfb\u52a0\u6210\u529f\uff01")},[]),x={labelAlign:"right",labelCol:{xs:{span:24},sm:{span:6}},wrapperCol:{xs:{span:24},sm:{span:16}}};return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",null,f.a.createElement(r["a"],{title:"\u6dfb\u52a0\u6210\u5458",visible:a,onOk:E,onCancel:()=>e.onCancel()},f.a.createElement(I["a"],Object.assign({},x),f.a.createElement(I["a"].Item,{label:"\u56e2\u5730\u540d\u79f0",className:"form-item"},p("teamId",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u56e2\u961f\u540d\u79f0"}]})(f.a.createElement(g["a"],null,t&&t.map(e=>{var a=e.title,t=e.value;return f.a.createElement(O,{key:t},a)})))),f.a.createElement(I["a"].Item,{label:"\u59d3\u540d",className:"form-item"},p("name",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u59d3\u540d"}]})(f.a.createElement(m["a"],null))),f.a.createElement(I["a"].Item,{label:"\u8054\u7cfb\u7535\u8bdd",className:"form-item"},p("phone",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7535\u8bdd\u53f7"},{pattern:/^1[3,5,6,7,8]\d{9}$/,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801"}]})(f.a.createElement(m["a"],null))),f.a.createElement(I["a"].Item,{label:"uid",className:"form-item"},p("uid",{rules:[{required:!0,message:"\u8bf7\u8f93\u5165uid"}]})(f.a.createElement(m["a"],null))),f.a.createElement(I["a"].Item,{label:"\u5fae\u4fe1\u53f7",className:"form-item"},p("wx",{})(f.a.createElement(m["a"],null))),f.a.createElement(I["a"].Item,{label:"\u9996\u6b21\u670d\u52a1",className:"form-item"},p("startTime",{rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u9996\u6b21\u670d\u52a1\u65f6\u95f4"}]})(f.a.createElement(y["a"],{style:{width:"100%"}})))))))},x=I["a"].create()(j),k=Object(h["memo"])(x),C=t("fcGt"),N=t("uDfI"),D=(t("/J1E"),[{value:"\u7528\u6237\u7559\u5b58\u8d28\u91cf\u4e0d\u8fbe\u6807",title:"\u7528\u6237\u7559\u5b58\u8d28\u91cf\u4e0d\u8fbe\u6807"},{value:"\u63a8\u5e7f\u91cf\u6548\u679c\u4e0d\u8fbe\u6807",title:"\u63a8\u5e7f\u91cf\u6548\u679c\u4e0d\u8fbe\u6807"},{value:"\u7591\u4f3c\u51fa\u73b0\u4f5c\u5f0a\u73b0\u8c61",title:"\u7591\u4f3c\u51fa\u73b0\u4f5c\u5f0a\u73b0\u8c61"},{value:"\u63a8\u5e7f\u5468\u671f\u7ed3\u675f\uff0c\u6b63\u5e38\u7ec8\u6b62",title:"\u63a8\u5e7f\u5468\u671f\u7ed3\u675f\uff0c\u6b63\u5e38\u7ec8\u6b62"},{value:"\u7a81\u53d1\u60c5\u51b5\uff0c\u7ec8\u6b62\u63a8\u5e7f\u5408\u4f5c",title:"\u7a81\u53d1\u60c5\u51b5\uff0c\u7ec8\u6b62\u63a8\u5e7f\u5408\u4f5c"}]),S=e=>{var a=e.user,t=e.dispatch,n=e.others,i=n.allTeams,u=n.allCities,b=[{title:"\u59d3\u540d",dataIndex:"name",key:"name"},{title:"\u7f16\u53f7ID",dataIndex:"id",key:"id"},{title:"\u8054\u7cfb\u7535\u8bdd",dataIndex:"phone",key:"phone"},{title:"\u5fae\u4fe1\u53f7",dataIndex:"wx",key:"wx"},{title:"uid",dataIndex:"uid",key:"uid"},{title:"\u6240\u5c5e\u56e2\u961f",dataIndex:"teamName",key:"teamName"},{title:"\u56e2\u961f\u7f16\u53f7",dataIndex:"teamId",key:"teamId"},{title:"\u9996\u6b21\u670d\u52a1",dataIndex:"startTime",key:"startTime",render:e=>e&&E()(e).format("YYYY-MM-DD")},{title:"\u670d\u52a1\u7ed3\u675f",dataIndex:"endTime",key:"endTime",render:e=>e&&E()(e).format("YYYY-MM-DD")},{title:"\u72b6\u6001",dataIndex:"status",key:"status",render:e=>1===e?"\u670d\u52a1\u4e2d":"\u505c\u6b62\u670d\u52a1"},{title:"\u64cd\u4f5c",dataIndex:"operation",key:"operation",render:(e,a)=>f.a.createElement(p["a"],{type:"link",size:"small",onClick:()=>ze(a.id,a.status)},1===a.status?"\u505c\u6b62":"\u6062\u590d")},{title:"\u505c\u6b62\u670d\u52a1\u539f\u56e0",dataIndex:"stopReason",key:"stopReason",render:(e,a)=>f.a.createElement("span",null,1===a.status?"-":a.stopReason)}],y={name:"\u59d3\u540d",id:"\u7f16\u53f7ID",phone:"\u8054\u7cfb\u7535\u8bdd",wx:"\u5fae\u4fe1\u53f7",uid:"uid",teamName:"\u6240\u5c5e\u56e2\u961f",teamId:"\u56e2\u961f\u7f16\u53f7",startTime:"\u9996\u6b21\u670d\u52a1",endTime:"\u670d\u52a1\u7ed3\u675f",status:"\u5f53\u524d\u72b6\u6001",stopReason:"\u505c\u6b62\u670d\u52a1\u539f\u56e0"},I=Object(h["useState"])(!1),g=d()(I,2),O=g[0],j=g[1],x=Object(h["useState"])(!1),N=d()(x,2),S=N[0],M=N[1],T=Object(h["useState"])(),z=d()(T,2),_=z[0],Y=z[1],R=Object(h["useState"])(),q=d()(R,2),A=q[0],J=q[1],F=Object(h["useState"])(1),H=d()(F,2),Q=H[0],U=H[1],G=Object(h["useState"])(10),K=d()(G,2),P=K[0],V=K[1],Z=Object(h["useState"])(),B=d()(Z,2),L=B[0],X=B[1],$=Object(h["useState"])(),W=d()($,2),ee=W[0],ae=W[1],te=Object(h["useState"])(),ne=d()(te,2),le=ne[0],re=ne[1],se=Object(h["useState"])(),me=d()(se,2),ie=me[0],ce=me[1],oe=Object(h["useState"])(),ue=d()(oe,2),de=ue[0],pe=ue[1],he=Object(h["useState"])(),fe=d()(he,2),be=fe[0],Ee=fe[1],ve=Object(h["useState"])(!1),ye=d()(ve,2),Ie=ye[0],ge=ye[1],we=Object(w["a"])("/pushMan/list"),Oe=we.data,je=we.fetchData,xe=Object(w["a"])("/pushMan/list"),ke=xe.data,Ce=xe.fetchData,Ne=Object(w["a"])("/pushMan/updateStatus"),De=Ne.fetchData;function Se(e){var a=e.id,t=e.name,n=e.phone,l=e.wx,r=e.teamId,s=e.teamName,m=e.status,i=e.uid,c=e.startTime,o=e.endTime,u=e.stopReason,p={id:a,name:t,phone:n,wx:l,teamId:r,teamName:s,uid:i,startTime:c,endTime:o,status:1===m?"\u670d\u52a1\u4e2d":"\u505c\u6b62\u670d\u52a1",stopReason:1===m?void 0:u},h=Object.entries(p).map(e=>{var a=d()(e,2),t=a[0],n=a[1];return[y[t],n]});return Object.fromEntries(h)}Object(h["useEffect"])(()=>{i&&0!==i.length||t({type:"others/fetchAllTeams"}),u&&0!==u.length||t({type:"others/fetchAllCities"}),Te()},[]),Object(h["useEffect"])(()=>{Ie&&Ce({offset:0,limit:999999,teamIds:_,cityIds:A,name:ie,pushManId:de,phone:be})},[Ie]),Object(h["useEffect"])(()=>{if(Ie)try{Object(C["b"])(ke&&ke.list,"\u5730\u63a8\u5458\u5217\u8868",Se)}catch(e){o["a"].error("\u51fa\u9519\u4e86\u3002\u3002"),console.log(e,"error happened in downloading....")}finally{ge(!1)}},[ke]);var Me=e=>{var a=e.current,t=void 0===a?1:a,n=e.pageSize,l=void 0===n?10:n,r={offset:l*(t-1),limit:l,teamIds:_,cityIds:A,name:ie,pushManId:de,phone:be};U(t),V(l),je(Object(C["e"])(r))},Te=()=>{var e={offset:P*(Q-1),limit:P,teamIds:_,cityIds:A,name:ie,pushManId:de,phone:be};je(Object(C["e"])(e))};function ze(e,a){X(e),ae(a),j(!0)}function _e(){return Ye.apply(this,arguments)}function Ye(){return Ye=c()(l.a.mark(function e(){var a;return l.a.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return j(!1),a={id:L,status:0==ee?1:0,stopReason:le},e.next=4,De(a);case 4:Te();case 5:case"end":return e.stop()}},e)})),Ye.apply(this,arguments)}function Re(){j(!1)}return f.a.createElement(f.a.Fragment,null,f.a.createElement("div",{className:"add_content"},f.a.createElement("h3",null,"\u4eba\u5458\u67e5\u8be2"),f.a.createElement(p["a"],{className:"add_btn",icon:"plus",type:"primary",size:"small",onClick:()=>M(!0)},"\u6dfb\u52a0\u5730\u63a8\u4eba\u5458")),f.a.createElement("div",{className:"memberAuth-operation"},f.a.createElement("div",{className:"query_param"},f.a.createElement("div",null,f.a.createElement("div",null,f.a.createElement("label",{className:"team_attribute"},"\u56e2\u961f\u5c5e\u6027"),f.a.createElement(v["e"],{mode:"multiple",allowClear:!0,placeholder:"\u8bf7\u9009\u62e9\u56e2\u961f",filter:!0,style:{width:200,marginRight:10},size:"small",options:i||[],onChange:e=>Y(e)}),f.a.createElement(v["e"],{placeholder:"\u8bf7\u9009\u62e9\u57ce\u5e02",mode:"multiple",allowClear:!0,filter:!0,style:{width:200,marginRight:10},options:u||[],onChange:e=>J(e)})),f.a.createElement("div",{className:"staff"},f.a.createElement("label",{className:"team_attribute"},"\u4eba\u5458\u5c5e\u6027"),f.a.createElement(m["a"],{size:"small",onChange:e=>ce(e.target.value),placeholder:"\u59d3\u540d"}),f.a.createElement(m["a"],{size:"small",onChange:e=>pe(e.target.value),placeholder:"\u7f16\u53f7ID"}),f.a.createElement(m["a"],{size:"small",onChange:e=>Ee(e.target.value),placeholder:"\u8054\u7cfb\u7535\u8bdd"}))),f.a.createElement(p["a"],{type:"primary",size:"small",onClick:()=>Te()},"\u67e5\u8be2")),f.a.createElement(p["a"],{type:"primary",size:"small",onClick:()=>ge(!0)},"\u4e0b\u8f7dcsv")),f.a.createElement("div",null,f.a.createElement(s["a"],{pagination:{size:"small",total:Oe&&Oe.total,pageSize:Oe&&Oe.pageSize,showQuickJumper:!0,showSizeChanger:!0,showTotal:e=>"\u603b\u8ba1".concat(e,"\u6761\u7ed3\u679c")},bordered:!0,onChange:Me,rowKey:"id",scroll:{x:"max-content"},columns:b,dataSource:Oe&&Oe.list})),f.a.createElement("div",null,f.a.createElement(r["a"],{visible:O,onOk:_e,onCancel:Re},1==ee&&f.a.createElement("p",null,"\u786e\u5b9a\u8981\u7ec8\u6b62\u5408\u4f5c\uff1f"),0==ee&&f.a.createElement("p",null,"\u786e\u5b9a\u8981\u6062\u590d\u5408\u4f5c\uff1f"),1==ee&&f.a.createElement("div",null,f.a.createElement("label",null,"\u7406\u7531:"),f.a.createElement(v["e"],{className:"team",options:D,onChange:e=>re(e),style:{width:"200px"}})))),f.a.createElement(k,{visible:S,user:a,teamData:i,onOk:()=>{console.log("ok")},onCancel:()=>M(!1),onAddMember:()=>{Te(),M(!1)}}))};a["default"]=Object(N["c"])(e=>({user:e.user,others:e.others}))(Object(h["memo"])(S))}}]);