(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[6],{HxoE:function(e,t,a){"use strict";a.r(t);a("YdMF");var c=a("dVZ9"),n=(a("zI7Q"),a("SCaQ")),s=a("JCfe"),l=a.n(s),r=(a("IJu9"),a("DuHN")),o=a("maMK"),i=a.n(o),m=a("ERkP"),d=a.n(m),u=a("uDfI"),b=a("wgY5"),f=a.n(b),O=a("7cJT"),v=a("jGgj"),h=a("fcGt"),j=a("N+uz"),S=(a("y0tC"),[{name:"\u56e2\u961f",value:"teamIds"},{name:"\u57ce\u5e02",value:"cityIds"}]),p=[{name:"\u6709\u6548\u6fc0\u6d3b\u8bbe\u5907",value:"activationCount"},{name:"\u65e0\u6548\u6fc0\u6d3b\u8bbe\u5907",value:"cheaterCount"},{name:"\u6b21\u65e5\u7559\u5b58",value:"oneDayRetention"},{name:"7\u65e5\u7559\u5b58",value:"sevenDayRetention"},{name:"30\u65e5\u7559\u5b58",value:"thirtyDayRetention"}],y=e=>{var t=e.others,a=e.dispatch,s=t.allTeams,o=t.allCities,u=localStorage.getItem("teamStatisticScreen"),b=u?JSON.parse(u).defaultDate:7,y=u?JSON.parse(u).screenType:"teamIds",g=u?JSON.parse(u).queryValue:void 0,C=Object(h["f"])(Date.now()-24*b*3600*1e3),E=Object(h["f"])(Date.now()-864e5),D=Object(j["a"])("/teamStat/data"),T=D.data,w=D.fetchData,N=Object(j["a"])("/teamStat/dataPage"),k=N.data,z=N.fetchData,I=Object(j["a"])("/teamStat/dataPage"),J=I.data,R=I.fetchData,Y=Object(m["useState"])([]),M=i()(Y,2),V=M[0],K=M[1],P=Object(m["useState"])("activationCount"),Q=i()(P,2),q=Q[0],A=Q[1],F=Object(m["useState"])(1),G=i()(F,2),H=G[0],x=G[1],Z=Object(m["useState"])(10),B=i()(Z,2),L=B[0],U=B[1],W=Object(m["useState"])(),X=i()(W,2),$=X[0],_=X[1],ee=Object(m["useState"])(!1),te=i()(ee,2),ae=te[0],ce=te[1],ne=Object(m["useState"])(y),se=i()(ne,2),le=se[0],re=se[1],oe=Object(m["useState"])(g),ie=i()(oe,2),me=ie[0],de=ie[1],ue=Object(m["useState"])(C),be=i()(ue,2),fe=be[0],Oe=be[1],ve=Object(m["useState"])(E),he=i()(ve,2),je=he[0],Se=he[1],pe=Object(m["useState"])(b),ye=i()(pe,2),ge=ye[0],Ce=ye[1];Object(m["useEffect"])(()=>{s&&0!==s.length||a({type:"others/fetchAllTeams"}),o&&0!==o.length||a({type:"others/fetchAllCities"}),w({startTime:fe,endTime:je,[le]:me}),z({startTime:fe,endTime:je,offset:0,limit:10,[le]:me})},[]),Object(m["useEffect"])(()=>{if(s&&o)switch(le){case"cityIds":K(o);break;case"teamIds":default:K(s)}},[le,s,o]),Object(m["useEffect"])(()=>{ae&&R({startTime:fe,endTime:je,offset:0,limit:999999,[le]:me})},[ae]),Object(m["useEffect"])(()=>{if(ae)try{Object(h["b"])(J&&J.list,"\u56e2\u961f/\u533a\u57df\u7edf\u8ba1\u6570\u636e",Ee)}catch(e){r["a"].error("\u51fa\u9519\u4e86\u3002\u3002"),console.log(e,"error happened in downloading....")}finally{ce(!1)}},[J]);var Ee=Object(m["useCallback"])(e=>{var t=e.oneDayRetention,a=e.sevenDayRetention,c=e.thirtyDayRetention,n=l()({},e,{oneDayRetention:t&&"".concat(Object(h["d"])(100*t),"%"),sevenDayRetention:a&&"".concat(Object(h["d"])(100*a),"%"),thirtyDayRetention:c&&"".concat(Object(h["d"])(100*c),"%")}),s=Object.entries(n).map(e=>{var t=i()(e,2),a=t[0],c=t[1];return[v["a"][a],c]});return Object.fromEntries(s)},[]),De=Object(m["useCallback"])(()=>{w({startTime:fe,endTime:je,[le]:me}),z({startTime:fe,endTime:je,offset:(H-1)*L,limit:L,desc:"ascend"===$?"asc":void 0,[le]:me})},[fe,je,L,H,$,le,me]),Te=(e,t)=>{Oe(e&&e.format("YYYY-MM-DD")),Se(t&&t.format("YYYY-MM-DD"))},we=Object(m["useCallback"])((e,t,a)=>{var c=e.current,n=void 0===c?1:c,s=e.pageSize,l=void 0===s?10:s,r=a.order;U(l),x(n),_(r),z({startTime:fe,endTime:je,limit:l,offset:(n-1)*l,desc:"ascend"===r?"asc":void 0,[le]:me})},[le,me,fe,je]),Ne=Object(m["useCallback"])(()=>{localStorage.setItem("teamStatisticScreen",JSON.stringify({screenType:le,queryValue:me,defaultDate:ge})),r["a"].success("\u4fdd\u5b58\u6210\u529f")},[fe,je,le,me,ge]),ke=Object(m["useCallback"])(e=>{re(e),de(void 0)},[]);return d.a.createElement("div",{className:"board"},d.a.createElement("div",{className:"board-screen"},d.a.createElement("label",null,"\u65e5\u671f"),d.a.createElement(O["d"],{onSelectChange:Te,onFastsetChange:Ce,fastSet:!0,value:[f()(fe),f()(je)],tipContent:"\u4e0d\u542b\u5f53\u5929\u6570\u636e",defaultDate:ge})),d.a.createElement("div",{className:"board-screen"},d.a.createElement("label",null,"\u7b5b\u9009"),d.a.createElement(O["c"],{size:"small",value:le,radioOptions:S,onChange:e=>ke(e.target.value)}),d.a.createElement(O["e"],{className:"board-screen-select",mode:"multiple",options:V,placeholder:"\u8bf7\u9009\u62e9",value:me,filter:!0,onChange:e=>de(e.length>0?e:void 0)}),d.a.createElement(n["a"],{size:"small",type:"primary",onClick:De},"\u67e5\u8be2"),d.a.createElement(n["a"],{size:"small",onClick:Ne},"\u4fdd\u5b58\u7b5b\u9009\u53c2\u6570")),d.a.createElement("div",{className:"board-chart"},d.a.createElement("div",{className:"board-chart-operation"},d.a.createElement(O["c"],{size:"small",value:q,radioOptions:p,onChange:e=>A(e.target.value)}),d.a.createElement(n["a"],{onClick:()=>ce(!0),icon:"download",size:"small",type:"primary"},"\u4e0b\u8f7dCSV")),d.a.createElement("div",{className:"board-chart-polygonal"},d.a.createElement(O["b"],{dataSource:T,indicators:q,title:"\u56e2\u961f/\u533a\u57df\u7edf\u8ba1\u56fe"})),d.a.createElement(c["a"],{className:"board-chart-table",columns:v["b"],dataSource:k&&k.list||[],rowKey:e=>{var t=e.teamId,a=e.timeKey;return"".concat(t,"/").concat(a)},bordered:!0,onChange:we,pagination:{size:"small",total:k&&k.total,pageSize:k&&k.pageSize,showQuickJumper:!0,showSizeChanger:!0,showTotal:e=>"\u603b\u8ba1".concat(e,"\u6761\u7ed3\u679c")}})))},g=Object(m["memo"])(y);t["default"]=Object(u["c"])(e=>{return{others:e.others}})(g)}}]);