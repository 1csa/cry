(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[20],{"5U66":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n("ERkP"),o=d(r),i=n("aWzz"),l=d(i),u=n("iREn"),s=d(u);function d(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=function(e){function t(){return c(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p(t,e),a(t,[{key:"render",value:function(){return o.default.createElement("tr",null,this.props.children)}}]),t}(r.PureComponent);h.propTypes={row:l.default.number.isRequired,cells:l.default.arrayOf(l.default.shape(s.default)).isRequired},t.default=h},"7BYT":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n("ERkP"),o=d(r),i=n("aWzz"),l=d(i),u=n("iREn"),s=d(u);function d(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=function(e){function t(e){c(this,t);var n=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=n.handleChange.bind(n),n}return p(t,e),a(t,[{key:"componentDidMount",value:function(){this._input.focus()}},{key:"handleChange",value:function(e){this.props.onChange(e.target.value)}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,a=t.onKeyDown;return o.default.createElement("input",{ref:function(t){e._input=t},className:"data-editor",value:n,onChange:this.handleChange,onKeyDown:a})}}]),t}(r.PureComponent);t.default=h,h.propTypes={value:l.default.node.isRequired,row:l.default.number.isRequired,col:l.default.number.isRequired,cell:l.default.shape(s.default),onChange:l.default.func.isRequired,onCommit:l.default.func.isRequired,onRevert:l.default.func.isRequired,onKeyDown:l.default.func.isRequired}},D9Z2:function(e,t,n){"use strict";function a(e,t,n,a){var r=a(e,t,n);return null===r||"undefined"===typeof r?"":r}function r(e,t,n,r,o){var i=o?o(e,t,n):null;return null===i||"undefined"===typeof i?a(e,t,n,r):i}Object.defineProperty(t,"__esModule",{value:!0}),t.renderValue=a,t.renderData=r},"J+fT":function(e,t,n){"use strict";n.r(t);n("+L6B");var a=n("2/Rp"),r=n("JCfe"),o=n.n(r),i=n("maMK"),l=n.n(i),u=n("ERkP"),s=n.n(u),d=n("uDfI"),c=n("YkbN"),f=n.n(c),p=(n("tNW2"),e=>{var t=e.dispatch,n=e=>{for(var t=[],n=1;n<=20;n++)t.push([{value:void 0,key:"objectId"},{value:void 0,key:"description"}]);return e&&t.unshift([{value:"\u5a92\u4f53ID",key:"objectId"},{value:"\u5a92\u4f53\u540d\u79f0",key:"description"}]),t},r=Object(u["useState"])(n(!0)),i=l()(r,2),d=i[0],c=i[1],p=()=>{c([...d,...n(!1)])},h=()=>{c(d.slice(0,d.length-20))},v=e=>{var n=d.map(e=>[...e]);e.forEach(e=>{e.cell;var t=e.row,a=e.col,r=e.value;n[t][a]=o()({},n[t][a],{value:r})}),c(n);var a=n.map(e=>{return{[e[0].key]:e[0].value,[e[1].key]:e[1].value}}).filter((e,t)=>{if(0!==t)return(null===e||void 0===e?void 0:e.objectId)&&(null===e||void 0===e?void 0:e.description)});t({type:"synchronizeState/saveWebExcelData",payload:{webExcelData:a}})},y=()=>{c(n(!0)),t({type:"synchronizeState/saveWebExcelData",payload:{webExcelData:[]}})};return s.a.createElement(s.a.Fragment,null,s.a.createElement("div",{className:"excel-op-panel"},s.a.createElement("span",null,s.a.createElement("span",{style:{color:"red"}},"* "),s.a.createElement("span",null,"\u8bcd\u5185\u5bb9(",d.length-1,")\u884c")),s.a.createElement(a["a"],{type:"primary",size:"small",onClick:y},"\u6e05\u9664\u6240\u6709\u5f55\u5165\u5185\u5bb9")),d.length?s.a.createElement("div",{className:"item-block"},s.a.createElement(f.a,{data:d,valueRenderer:e=>null===e||void 0===e?void 0:e.value,onCellsChanged:e=>v(e)}),s.a.createElement("div",{className:"op-item-group"},s.a.createElement(a["a"],{size:"small",onClick:p},"\u589e\u52a020\u884c"),s.a.createElement(a["a"],{size:"small",disabled:d.length<=20,onClick:h},"\u5220\u966420\u884c"))):null)});t["default"]=Object(d["c"])()(p)},JBbm:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n("ERkP"),i=c(o),l=n("aWzz"),u=c(l),s=n("iREn"),d=c(s);function c(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function h(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var v=function(e){function t(){return f(this,t),p(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return h(t,e),r(t,[{key:"render",value:function(){var e=this.props,t=e.cell,n=e.row,r=e.col,o=e.attributesRenderer,l=e.className,u=e.style,s=e.onMouseDown,d=e.onMouseOver,c=e.onDoubleClick,f=e.onContextMenu,p=t.colSpan,h=t.rowSpan,v=o?o(t,n,r):{};return i.default.createElement("td",a({className:l,onMouseDown:s,onMouseOver:d,onDoubleClick:c,onTouchEnd:c,onContextMenu:f,colSpan:p,rowSpan:h,style:u},v),this.props.children)}}]),t}(o.PureComponent);t.default=v,v.propTypes={row:u.default.number.isRequired,col:u.default.number.isRequired,cell:u.default.shape(d.default).isRequired,selected:u.default.bool,editing:u.default.bool,updated:u.default.bool,attributesRenderer:u.default.func,onMouseDown:u.default.func.isRequired,onMouseOver:u.default.func.isRequired,onDoubleClick:u.default.func.isRequired,onContextMenu:u.default.func.isRequired,className:u.default.string,style:u.default.object},v.defaultProps={selected:!1,editing:!1,updated:!1,attributesRenderer:function(){}}},OtPC:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n("ERkP"),o=u(r),i=n("aWzz"),l=u(i);function u(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function d(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function c(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var f=function(e){function t(){return s(this,t),d(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return c(t,e),a(t,[{key:"render",value:function(){return o.default.createElement("table",{className:this.props.className},o.default.createElement("tbody",null,this.props.children))}}]),t}(r.PureComponent);f.propTypes={className:l.default.string,data:l.default.array.isRequired},t.default=f},SS4V:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e},r=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),o=n("ERkP"),i=w(o),l=n("aWzz"),u=w(l),s=n("OtPC"),d=w(s),c=n("5U66"),f=w(c),p=n("JBbm"),h=w(p),v=n("ZWdV"),y=w(v),b=n("7BYT"),m=w(b),g=n("vTPL"),E=w(g),C=n("nHWJ");function w(e){return e&&e.__esModule?e:{default:e}}function _(e,t){var n={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(n[a]=e[a]);return n}function j(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function R(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function k(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var O=function(e){return 0===Object.keys(e).length},D=function(e,t){for(var n=[],a=t-e>0,r=e;a?r<=t:r>=t;a?r++:r--)a?n.push(r):n.unshift(r);return n},S=function(e){return e.split(/\r\n|\n|\r/).map(function(e){return e.split("\t")})},M=function(e){function t(e){j(this,t);var n=R(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.onMouseDown=n.onMouseDown.bind(n),n.onMouseUp=n.onMouseUp.bind(n),n.onMouseOver=n.onMouseOver.bind(n),n.onDoubleClick=n.onDoubleClick.bind(n),n.onContextMenu=n.onContextMenu.bind(n),n.handleNavigate=n.handleNavigate.bind(n),n.handleKey=n.handleKey.bind(n).bind(n),n.handleCut=n.handleCut.bind(n),n.handleCopy=n.handleCopy.bind(n),n.handlePaste=n.handlePaste.bind(n),n.pageClick=n.pageClick.bind(n),n.onChange=n.onChange.bind(n),n.onRevert=n.onRevert.bind(n),n.isSelected=n.isSelected.bind(n),n.isEditing=n.isEditing.bind(n),n.isClearing=n.isClearing.bind(n),n.handleComponentKey=n.handleComponentKey.bind(n),n.handleKeyboardCellMovement=n.handleKeyboardCellMovement.bind(n),n.defaultState={start:{},end:{},selecting:!1,forceEdit:!1,editing:{},clear:{}},n.state=n.defaultState,n.removeAllListeners=n.removeAllListeners.bind(n),n.handleIEClipboardEvents=n.handleIEClipboardEvents.bind(n),n}return k(t,e),r(t,[{key:"removeAllListeners",value:function(){document.removeEventListener("mousedown",this.pageClick),document.removeEventListener("mouseup",this.onMouseUp),document.removeEventListener("cut",this.handleCut),document.removeEventListener("copy",this.handleCopy),document.removeEventListener("paste",this.handlePaste),document.removeEventListener("keydown",this.handleIEClipboardEvents)}},{key:"componentDidMount",value:function(){this.dgDom&&this.dgDom.addEventListener("keydown",this.handleComponentKey)}},{key:"componentWillUnmount",value:function(){this.dgDom&&this.dgDom.removeEventListener("keydown",this.handleComponentKey),this.removeAllListeners()}},{key:"isSelectionControlled",value:function(){return"selected"in this.props}},{key:"getState",value:function(){var e=this.state;if(this.isSelectionControlled()){var t=this.props.selected||{},n=t.start,r=t.end;n=n||this.defaultState.start,r=r||this.defaultState.end,e=a({},e,{start:n,end:r})}return e}},{key:"_setState",value:function(e){var t=this.props.editModeChanged;if(t&&e.editing){var n=!O(this.state.editing),a=!O(e.editing);n!=a&&t(a)}if(this.isSelectionControlled()&&("start"in e||"end"in e)){var r=e.start,o=e.end,i=_(e,["start","end"]),l=this.props,u=l.selected,s=l.onSelect;u=u||{},r||(r="start"in u?u.start:this.defaultState.start),o||(o="end"in u?u.end:this.defaultState.end),s&&s({start:r,end:o}),this.setState(i)}else this.setState(e)}},{key:"pageClick",value:function(e){if(!this.props.disablePageClick){var t=this.dgDom;t.contains(e.target)||(this.setState(this.defaultState),this.removeAllListeners())}}},{key:"handleCut",value:function(e){if(O(this.state.editing)){e.preventDefault(),this.handleCopy(e);var t=this.getState(),n=t.start,a=t.end;this.clearSelectedCells(n,a)}}},{key:"handleIEClipboardEvents",value:function(e){e.ctrlKey&&(67===e.keyCode?this.handleCopy(e):88===e.keyCode?this.handleCut(e):86!==e.keyCode&&86!==e.which||this.handlePaste(e))}},{key:"handleCopy",value:function(e){if(O(this.state.editing)){e.preventDefault();var t=this.props,n=t.dataRenderer,a=t.valueRenderer,r=t.data,o=this.getState(),i=o.start,l=o.end;if(this.props.handleCopy)this.props.handleCopy({event:e,dataRenderer:n,valueRenderer:a,data:r,start:i,end:l,range:D});else{var u=D(i.i,l.i).map(function(e){return D(i.j,l.j).map(function(t){var o=r[e][t],i=n?n(o,e,t):null;return""===i||null===i||"undefined"===typeof i?a(o,e,t):i}).join("\t")}).join("\n");window.clipboardData&&window.clipboardData.setData?window.clipboardData.setData("Text",u):e.clipboardData.setData("text/plain",u)}}}},{key:"handlePaste",value:function(e){if(O(this.state.editing)){var t=this.getState(),n=t.start,a=t.end;n={i:Math.min(n.i,a.i),j:Math.min(n.j,a.j)},a={i:Math.max(n.i,a.i),j:Math.max(n.j,a.j)};var r=this.props.parsePaste||S,o=[],i=[];window.clipboardData&&window.clipboardData.getData?i=r(window.clipboardData.getData("Text")):e.clipboardData&&e.clipboardData.getData&&(i=r(e.clipboardData.getData("text/plain")));var l=this.props,u=l.data,s=l.onCellsChanged,d=l.onPaste,c=l.onChange;if(s){var f=[];i.forEach(function(e,t){e.forEach(function(e,r){a={i:n.i+t,j:n.j+r};var i=u[a.i]&&u[a.i][a.j];i?i.readOnly||o.push({cell:i,row:a.i,col:a.j,value:e}):f.push({row:a.i,col:a.j,value:e})})}),f.length?s(o,f):s(o)}else d?(i.forEach(function(e,t){var r=[];e.forEach(function(e,o){a={i:n.i+t,j:n.j+o};var i=u[a.i]&&u[a.i][a.j];r.push({cell:i,data:e})}),o.push(r)}),d(o)):c&&i.forEach(function(e,t){e.forEach(function(e,r){a={i:n.i+t,j:n.j+r};var o=u[a.i]&&u[a.i][a.j];o&&!o.readOnly&&c(o,a.i,a.j,e)})});this._setState({end:a})}}},{key:"handleKeyboardCellMovement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getState(),a=n.start,r=n.editing,o=this.props.data,i=r&&!O(r),l=o[a.i]&&o[a.i][a.j];if(i&&!t)return!1;var u=l&&l.component,s=e.which||e.keyCode;u&&i?e.preventDefault():s===C.TAB_KEY?this.handleNavigate(e,{i:0,j:e.shiftKey?-1:1},!0):s===C.RIGHT_KEY?this.handleNavigate(e,{i:0,j:1}):s===C.LEFT_KEY?this.handleNavigate(e,{i:0,j:-1}):s===C.UP_KEY?this.handleNavigate(e,{i:-1,j:0}):s===C.DOWN_KEY?this.handleNavigate(e,{i:1,j:0}):t&&s===C.ENTER_KEY&&this.handleNavigate(e,{i:e.shiftKey?-1:1,j:0})}},{key:"handleKey",value:function(e){if(!e.isPropagationStopped||!e.isPropagationStopped()){var t=e.which||e.keyCode,n=this.getState(),a=n.start,r=n.end,o=n.editing,i=o&&!O(o),l=!a||O(a),u=e.ctrlKey||e.metaKey,s=t===C.DELETE_KEY||t===C.BACKSPACE_KEY,d=t===C.ENTER_KEY,c=t>=48&&t<=57,f=t>=65&&t<=90,p=t>=160&&t<=255,h=t>=96&&t<=105,v=!l&&this.props.data[a.i][a.j],y=[187,189,190,107,109,110].indexOf(t)>-1;if(l||u)return!0;i||(this.handleKeyboardCellMovement(e),s?(e.preventDefault(),this.clearSelectedCells(a,r)):v&&!v.readOnly&&(d?(this._setState({editing:a,clear:{},forceEdit:!0}),e.preventDefault()):(c||h||f||p||y)&&this._setState({editing:a,clear:a,forceEdit:!1})))}}},{key:"getSelectedCells",value:function(e,t,n){var a=[];return D(t.i,n.i).map(function(r){D(t.j,n.j).map(function(t){e[r]&&e[r][t]&&a.push({cell:e[r][t],row:r,col:t})})}),a}},{key:"clearSelectedCells",value:function(e,t){var n=this,r=this.props,o=r.data,i=r.onCellsChanged,l=r.onChange,u=this.getSelectedCells(o,e,t).filter(function(e){return!e.cell.readOnly}).map(function(e){return a({},e,{value:""})});i?(i(u),this.onRevert()):l&&setTimeout(function(){u.forEach(function(e){var t=e.cell,n=e.row,a=e.col,r=e.value;l(t,n,a,r)}),n.onRevert()},0)}},{key:"updateLocationSingleCell",value:function(e){this._setState({start:e,end:e,editing:{}})}},{key:"updateLocationMultipleCells",value:function(e){var t=this.getState(),n=t.start,a=t.end,r=this.props.data,o={i:n.i,j:n.j},i={i:a.i+e.i,j:Math.min(r[0].length-1,Math.max(0,a.j+e.j))};this._setState({start:o,end:i,editing:{}})}},{key:"searchForNextSelectablePos",value:function(e,t,n,a,r){var o=function(e){return{i:e.i-1,j:t[0].length-1}},i=function(e){return{i:e.i+1,j:0}},l=function(e){return{i:e.i+a.i,j:e.j+a.j}},u=function(e){var n=e.i,a=e.j;return t[n]&&"undefined"!==typeof t[n][a]},s=l(n);while(u(s)&&!e(t[s.i][s.j],s.i,s.j))s=l(s);if(!u(s)){if(!r)return null;s=a.j<0?o(s):i(s)}return u(s)&&!e(t[s.i][s.j],s.i,s.j)?this.searchForNextSelectablePos(e,t,s,a,r):u(s)?s:null}},{key:"handleNavigate",value:function(e,t,n){if(t&&(t.i||t.j)){var a=this.props.data,r=this.getState(),o=r.start,i=e.shiftKey&&!n,l=this.props.isCellNavigable?this.props.isCellNavigable:function(){return!0};if(i)this.updateLocationMultipleCells(t);else{var u=this.searchForNextSelectablePos(l,a,o,t,n);u&&this.updateLocationSingleCell(u)}e.preventDefault()}}},{key:"handleComponentKey",value:function(e){var t=this,n=e.which||e.keyCode;if([C.ENTER_KEY,C.ESCAPE_KEY,C.TAB_KEY].includes(n)){var a=this.state.editing,r=this.props.data,o=!O(a);if(o){var i=r[a.i][a.j],l=e.shiftKey?-1:1;if(i&&i.component&&!i.forceComponent){e.preventDefault();var u=this.onRevert;n===C.ENTER_KEY?u=function(){return t.handleNavigate(e,{i:l,j:0})}:n===C.TAB_KEY&&(u=function(){return t.handleNavigate(e,{i:0,j:l},!0)}),setTimeout(function(){u(),t.dgDom&&t.dgDom.focus({preventScroll:!0})},1)}}}}},{key:"onContextMenu",value:function(e,t,n){var a=this.props.data[t][n];this.props.onContextMenu&&this.props.onContextMenu(e,a,t,n)}},{key:"onDoubleClick",value:function(e,t){var n=this.props.data[e][t];n.readOnly||this._setState({editing:{i:e,j:t},forceEdit:!0,clear:{}})}},{key:"onMouseDown",value:function(e,t,n){var a=!O(this.state.editing)&&this.state.editing.i===e&&this.state.editing.j===t,r=O(this.state.editing)||this.state.editing.i!==e||this.state.editing.j!==t?{}:this.state.editing;this._setState({selecting:!a,start:n.shiftKey?this.getState().start:{i:e,j:t},end:{i:e,j:t},editing:r,forceEdit:!!a});var o=window.navigator.userAgent,i=/MSIE|Trident/.test(o);i&&document.addEventListener("keydown",this.handleIEClipboardEvents),document.addEventListener("mouseup",this.onMouseUp),document.addEventListener("mousedown",this.pageClick),document.addEventListener("cut",this.handleCut),document.addEventListener("copy",this.handleCopy),document.addEventListener("paste",this.handlePaste)}},{key:"onMouseOver",value:function(e,t){this.state.selecting&&O(this.state.editing)&&this._setState({end:{i:e,j:t}})}},{key:"onMouseUp",value:function(){this._setState({selecting:!1}),document.removeEventListener("mouseup",this.onMouseUp)}},{key:"onChange",value:function(e,t,n){var a=this.props,r=a.onChange,o=a.onCellsChanged,i=a.data;o?o([{cell:i[e][t],row:e,col:t,value:n}]):r&&r(i[e][t],e,t,n),this.onRevert()}},{key:"onRevert",value:function(){var e=this;this._setState({editing:{}}),setTimeout(function(){e.dgDom&&e.dgDom.focus({preventScroll:!0})},1)}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,a=n.start,r=n.end,o=t.end;O(r)||r.i===o.i&&r.j===o.j||this.isSelectionControlled()||this.props.onSelect&&this.props.onSelect({start:a,end:r})}},{key:"isSelectedRow",value:function(e){var t=this.getState(),n=t.start,a=t.end,r=n.i,o=a.i;return r<=o?e>=r&&e<=o:e<=r&&e>=o}},{key:"isSelected",value:function(e,t){var n=this.getState(),a=n.start,r=n.end,o=t>=a.j&&t<=r.j,i=t<=a.j&&t>=r.j,l=e>=a.i&&e<=r.i,u=e<=a.i&&e>=r.i;return o&&l||i&&l||i&&u||o&&u}},{key:"isEditing",value:function(e,t){return this.state.editing.i===e&&this.state.editing.j===t}},{key:"isClearing",value:function(e,t){return this.state.clear.i===e&&this.state.clear.j===t}},{key:"render",value:function(){var e=this,t=this.props,n=t.sheetRenderer,r=t.rowRenderer,o=t.cellRenderer,l=t.dataRenderer,u=t.valueRenderer,s=t.dataEditor,d=t.valueViewer,c=t.attributesRenderer,f=t.className,p=t.overflow,h=t.data,v=t.keyFn,b=this.state.forceEdit;return i.default.createElement("span",{ref:function(t){e.dgDom=t},tabIndex:"0",className:"data-grid-container",onKeyDown:this.handleKey},i.default.createElement(n,{data:h,className:["data-grid",f,p].filter(function(e){return e}).join(" ")},h.map(function(t,n){return i.default.createElement(r,{key:v?v(n):n,row:n,cells:t,selected:e.isSelectedRow(n)},t.map(function(t,r){var f=e.isEditing(n,r);return i.default.createElement(y.default,a({key:t.key?t.key:n+"-"+r,row:n,col:r,cell:t,forceEdit:!1,onMouseDown:e.onMouseDown,onMouseOver:e.onMouseOver,onDoubleClick:e.onDoubleClick,onContextMenu:e.onContextMenu,onChange:e.onChange,onRevert:e.onRevert,onNavigate:e.handleKeyboardCellMovement,onKey:e.handleKey,selected:e.isSelected(n,r),editing:f,clearing:e.isClearing(n,r),attributesRenderer:c,cellRenderer:o,valueRenderer:u,dataRenderer:l,valueViewer:d,dataEditor:s},f?{forceEdit:b}:{}))}))})))}}]),t}(o.PureComponent);t.default=M,M.propTypes={data:u.default.array.isRequired,className:u.default.string,disablePageClick:u.default.bool,overflow:u.default.oneOf(["wrap","nowrap","clip"]),onChange:u.default.func,onCellsChanged:u.default.func,onContextMenu:u.default.func,onSelect:u.default.func,isCellNavigable:u.default.func,selected:u.default.shape({start:u.default.shape({i:u.default.number,j:u.default.number}),end:u.default.shape({i:u.default.number,j:u.default.number})}),valueRenderer:u.default.func.isRequired,dataRenderer:u.default.func,sheetRenderer:u.default.func.isRequired,rowRenderer:u.default.func.isRequired,cellRenderer:u.default.func.isRequired,valueViewer:u.default.func,dataEditor:u.default.func,parsePaste:u.default.func,attributesRenderer:u.default.func,keyFn:u.default.func,handleCopy:u.default.func,editModeChanged:u.default.func},M.defaultProps={sheetRenderer:d.default,rowRenderer:f.default,cellRenderer:h.default,valueViewer:E.default,dataEditor:m.default}},YkbN:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.renderData=t.renderValue=t.ValueViewer=t.DataEditor=t.Cell=t.Row=t.Sheet=void 0;var a=n("SS4V"),r=y(a),o=n("OtPC"),i=y(o),l=n("5U66"),u=y(l),s=n("JBbm"),d=y(s),c=n("7BYT"),f=y(c),p=n("vTPL"),h=y(p),v=n("D9Z2");function y(e){return e&&e.__esModule?e:{default:e}}t.default=r.default,t.Sheet=i.default,t.Row=u.default,t.Cell=d.default,t.DataEditor=f.default,t.ValueViewer=h.default,t.renderValue=v.renderValue,t.renderData=v.renderData},ZWdV:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n("ERkP"),o=m(r),i=n("aWzz"),l=m(i),u=n("nHWJ"),s=n("JBbm"),d=m(s),c=n("iREn"),f=m(c),p=n("7BYT"),h=m(p),v=n("vTPL"),y=m(v),b=n("D9Z2");function m(e){return e&&e.__esModule?e:{default:e}}function g(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function E(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function C(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function w(e){var t=e.cell,n=e.row,a=e.col,r=e.valueRenderer,o=e.dataRenderer;return(0,b.renderData)(t,n,a,r,o)}function _(e){var t=e.cell,n=e.row,a=e.col,r=e.valueRenderer;return(0,b.renderValue)(t,n,a,r)}function j(e){var t="number"===typeof e.width?e.width+"px":e.width;return t?{width:t}:null}var R=function(e){function t(e){g(this,t);var n=E(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.handleChange=n.handleChange.bind(n),n.handleCommit=n.handleCommit.bind(n),n.handleRevert=n.handleRevert.bind(n),n.handleKey=n.handleKey.bind(n),n.handleMouseDown=n.handleMouseDown.bind(n),n.handleMouseOver=n.handleMouseOver.bind(n),n.handleContextMenu=n.handleContextMenu.bind(n),n.handleDoubleClick=n.handleDoubleClick.bind(n),n.state={updated:!1,reverting:!1,committing:!1,value:""},n}return C(t,e),a(t,[{key:"componentDidUpdate",value:function(e){var t=this;if(this.props.cell.disableUpdatedFlag||_(e)===_(this.props)||(this.setState({updated:!0}),this.timeout=setTimeout(function(){return t.setState({updated:!1})},700)),!0===this.props.editing&&!1===e.editing){var n=this.props.clearing?"":w(this.props);this.setState({value:n,reverting:!1})}!0!==e.editing||!1!==this.props.editing||this.state.reverting||this.state.committing||this.state.value===w(this.props)||this.props.onChange(this.props.row,this.props.col,this.state.value)}},{key:"componentWillUnmount",value:function(){clearTimeout(this.timeout)}},{key:"handleChange",value:function(e){this.setState({value:e,committing:!1})}},{key:"handleCommit",value:function(e,t){var n=this.props,a=n.onChange,r=n.onNavigate;e!==w(this.props)?(this.setState({value:e,committing:!0}),a(this.props.row,this.props.col,e)):this.handleRevert(),t&&(t.preventDefault(),r(t,!0))}},{key:"handleRevert",value:function(){this.setState({reverting:!0}),this.props.onRevert()}},{key:"handleMouseDown",value:function(e){var t=this.props,n=t.row,a=t.col,r=t.onMouseDown,o=t.cell;o.disableEvents||r(n,a,e)}},{key:"handleMouseOver",value:function(e){var t=this.props,n=t.row,a=t.col,r=t.onMouseOver,o=t.cell;o.disableEvents||r(n,a)}},{key:"handleDoubleClick",value:function(e){var t=this.props,n=t.row,a=t.col,r=t.onDoubleClick,o=t.cell;o.disableEvents||r(n,a)}},{key:"handleContextMenu",value:function(e){var t=this.props,n=t.row,a=t.col,r=t.onContextMenu,o=t.cell;o.disableEvents||r(e,n,a)}},{key:"handleKey",value:function(e){var t=e.which||e.keyCode;if(t===u.ESCAPE_KEY)return this.handleRevert();var n=this.props,a=n.cell.component,r=n.forceEdit,o=r||!!a,i=t===u.ENTER_KEY||t===u.TAB_KEY||!o&&[u.LEFT_KEY,u.RIGHT_KEY,u.UP_KEY,u.DOWN_KEY].includes(t);i&&this.handleCommit(this.state.value,e)}},{key:"renderComponent",value:function(e,t){var n=t.component,a=t.readOnly,r=t.forceComponent;if(e&&!a||r)return n}},{key:"renderEditor",value:function(e,t,n,a,r){if(e){var i=t.dataEditor||r||h.default;return o.default.createElement(i,{cell:t,row:n,col:a,value:this.state.value,onChange:this.handleChange,onCommit:this.handleCommit,onRevert:this.handleRevert,onKeyDown:this.handleKey})}}},{key:"renderViewer",value:function(e,t,n,a,r){var i=e.valueViewer||r||y.default,l=(0,b.renderValue)(e,t,n,a);return o.default.createElement(i,{cell:e,row:t,col:n,value:l})}},{key:"render",value:function(){var e=this.props,t=e.row,n=e.col,a=e.cell,r=e.cellRenderer,i=e.valueRenderer,l=e.dataEditor,u=e.valueViewer,s=e.attributesRenderer,d=e.selected,c=e.editing,f=e.onKeyUp,p=this.state.updated,h=this.renderComponent(c,a)||this.renderEditor(c,a,t,n,l)||this.renderViewer(a,t,n,i,u),v=[a.className,"cell",a.overflow,d&&"selected",c&&"editing",a.readOnly&&"read-only",p&&"updated"].filter(function(e){return e}).join(" ");return o.default.createElement(r,{row:t,col:n,cell:a,selected:d,editing:c,updated:p,attributesRenderer:s,className:v,style:j(a),onMouseDown:this.handleMouseDown,onMouseOver:this.handleMouseOver,onDoubleClick:this.handleDoubleClick,onContextMenu:this.handleContextMenu,onKeyUp:f},h)}}]),t}(r.PureComponent);t.default=R,R.propTypes={row:l.default.number.isRequired,col:l.default.number.isRequired,cell:l.default.shape(f.default).isRequired,forceEdit:l.default.bool,selected:l.default.bool,editing:l.default.bool,editValue:l.default.any,clearing:l.default.bool,cellRenderer:l.default.func,valueRenderer:l.default.func.isRequired,dataRenderer:l.default.func,valueViewer:l.default.func,dataEditor:l.default.func,attributesRenderer:l.default.func,onNavigate:l.default.func.isRequired,onMouseDown:l.default.func.isRequired,onMouseOver:l.default.func.isRequired,onDoubleClick:l.default.func.isRequired,onContextMenu:l.default.func.isRequired,onChange:l.default.func.isRequired,onRevert:l.default.func.isRequired,onEdit:l.default.func},R.defaultProps={forceEdit:!1,selected:!1,editing:!1,clearing:!1,cellRenderer:d.default}},iREn:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n("aWzz"),r=o(a);function o(e){return e&&e.__esModule?e:{default:e}}var i={readOnly:r.default.bool,key:r.default.string,className:r.default.string,component:r.default.oneOfType([r.default.element,r.default.func]),forceComponent:r.default.bool,disableEvents:r.default.bool,disableUpdatedFlag:r.default.bool,colSpan:r.default.number,rowSpan:r.default.number,width:r.default.oneOfType([r.default.number,r.default.string]),overflow:r.default.oneOf(["wrap","nowrap","clip"]),dataEditor:r.default.func,valueViewer:r.default.func};t.default=i},nHWJ:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TAB_KEY=9,t.ENTER_KEY=13,t.ESCAPE_KEY=27,t.LEFT_KEY=37,t.UP_KEY=38,t.RIGHT_KEY=39,t.DOWN_KEY=40,t.DELETE_KEY=46,t.BACKSPACE_KEY=8},tNW2:function(e,t,n){},vTPL:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),r=n("ERkP"),o=d(r),i=n("aWzz"),l=d(i),u=n("iREn"),s=d(u);function d(e){return e&&e.__esModule?e:{default:e}}function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}function p(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var h=function(e){function t(){return c(this,t),f(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return p(t,e),a(t,[{key:"render",value:function(){var e=this.props.value;return o.default.createElement("span",{className:"value-viewer"},e)}}]),t}(r.PureComponent);t.default=h,h.propTypes={row:l.default.number.isRequired,col:l.default.number.isRequired,cell:l.default.shape(s.default),value:l.default.node.isRequired}}}]);