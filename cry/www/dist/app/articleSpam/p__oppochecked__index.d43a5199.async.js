(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[14],{JMdb:function(e,a,t){"use strict";t.r(a);t("stmH");var r=t("5O1y"),n=(t("qXJo"),t("rAmn")),l=(t("42uY"),t("lGXO")),o=(t("FLAH"),t("excc")),s=(t("zI7Q"),t("SCaQ")),c=(t("Iaxd"),t("i6l0")),i=(t("oeo2"),t("BmDy")),d=(t("vgpD"),t("UL5a")),p=(t("gFku"),t("7WSx")),u=(t("M6c6"),t("jMRu")),m=(t("IJu9"),t("DuHN")),h=(t("ljfu"),t("x2dm")),g=t("ERkP"),E=t.n(g),v=t("wgY5"),w=t.n(v),y=(t("Iw6u"),t("ibId")),b=(t("LCbC"),t("NwOV")),f=(t("Yzaq"),t("d+ro")),C=t("Z32k"),x=t.n(C),_=t("JGaj"),D=t.n(_),S=t("ggb3"),A=t.n(S),k=t("wknW"),O=t("wZVN"),I=(t("wgAA"),t("n/bh"));class L extends E.a.PureComponent{constructor(e){super(e),this.updateCpp=(e=>{var a="e7d86aef18345a5a00041e4bb506f99a",t="webui@article-spam",r="/api/proxy/".concat(k["a"].API_k8s_HOST,"/prv/document/update");return new Promise((n,l)=>{A()({method:"post",url:r,data:{ob_quality_score:e.score},params:{docid:e.docid,from:t,key:a}}).then(e=>{n(e)}).catch(e=>{l(e)})})}),this.updateArticle=(e=>{return new Promise((a,t)=>{A.a.get("/api/proxy/".concat(k["a"].API_TOOLS_HOST,"/news-review/update-top-news"),{params:e}).then(e=>{a(e)}).catch(e=>{t(e)})})}),this.onPassArticle=(()=>{var e=this,a=this.props.doc;if(-1===a.score)return m["a"].error("\u8bc4\u5206\u548c\u64cd\u4f5c\u4e3a\u5fc5\u586b\u9879");e.handleArticle()}),this.onChangeArticleScore=(e=>{this.props.doc.newscore=e.target.value}),this.onChangeArticleReason=(e=>{this.props.doc.reason=e}),this.onOtherReasonChange=(e=>{this.props.doc.other_reason=e.target.value})}handleArticle(){var e=this;return D()(x.a.mark(function a(){var t,r,n,l,o,s;return x.a.wrap(function(a){while(1)switch(a.prev=a.next){case 0:if(t=e.props.doc,t.reason.includes("\u5176\u4ed6")&&(r=t.reason.indexOf("\u5176\u4ed6"),t.reason[r]=t.reason[r]+":"+t.other_reason),n={docid:t.doc_id,score:t.newscore,operation:"",reason:t.reason.join(","),operator_email:Object(O["a"])("username"),appid:"oppobrowser"},t.score!==t.newscore){a.next=17;break}return a.prev=4,a.next=7,e.updateArticle(n);case 7:l=a.sent,"success"===l.data.status?m["a"].success("\u64cd\u4f5c\u6210\u529f"):m["a"].error("\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"),a.next=15;break;case 11:a.prev=11,a.t0=a["catch"](4),console.log(a.t0),m["a"].error("\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5");case 15:a.next=31;break;case 17:return a.prev=17,a.next=20,e.updateCpp(n);case 20:return o=a.sent,a.next=23,e.updateArticle(n);case 23:s=a.sent,!0===o.data&&"success"===s.data.status?m["a"].success("\u64cd\u4f5c\u6210\u529f"):m["a"].error("\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"),a.next=31;break;case 27:a.prev=27,a.t1=a["catch"](17),console.log(a.t1),m["a"].error("\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5");case 31:case"end":return a.stop()}},a,null,[[4,11],[17,27]])}))()}render(){var e=this.props,a=e.doc,t=e.index;return E.a.createElement("div",{className:"audit-doc-wrapper"},E.a.createElement("div",{className:"doc-title"},E.a.createElement("span",null,t+1,".\xa0\xa0"),E.a.createElement("a",{href:"https://www.yidianzixun.com/article/".concat(a.doc_id,"?appid=heytap"),target:"_blank"},a.title)),E.a.createElement("div",{className:"doc-info"},a.media_id&&E.a.createElement(f["a"],{color:"#ffa500"},"\u81ea\u5a92\u4f53"),E.a.createElement("span",null,E.a.createElement("strong",null,"docid: "),a.doc_id),E.a.createElement("span",null,E.a.createElement("strong",null,"\u66dd\u5149\u91cf: "),a.cntView),E.a.createElement("span",null,E.a.createElement("strong",null,"\u5165\u5ba1\u6838\u6c60\u65f6\u95f4: "),a.insert_time),E.a.createElement("span",null,E.a.createElement("strong",null,"\u5927\u7c7b: "),a.category),E.a.createElement("span",null,E.a.createElement("strong",null,"\u6765\u6e90: "),a.source),E.a.createElement("span",null,E.a.createElement("strong",null,"\u8d26\u53f7id: "),a.media_id||""),E.a.createElement("span",null,E.a.createElement("strong",null,"\u6e90\u8bc4\u7ea7: "),a.source_tier),E.a.createElement("span",null,E.a.createElement("strong",null,"\u53d1\u5e03\u65e5\u671f: "),a.date),E.a.createElement("span",null,E.a.createElement("strong",null,"\u4f4e\u4fd7\u503c: "),a.sc_dirty),E.a.createElement("span",null,E.a.createElement("strong",null,"\u6807\u9898\u515a\u5c5e\u6027: "),a.bait),E.a.createElement("span",null,E.a.createElement("strong",null,"\u5ba1\u6838\u4eba: "),a.operator_email||"\u672a\u77e5"),E.a.createElement("span",null,E.a.createElement("strong",null,"\u5ba1\u6838\u65f6\u95f4: "),a.reviewed_time)),E.a.createElement("div",{className:"doc-oper-wrapper"},E.a.createElement("div",null,E.a.createElement("h4",{className:"opt-title"},"\u8bc4\u5206:"),E.a.createElement("div",{className:"opt-wrapper"},E.a.createElement(b["a"].Group,{onChange:this.onChangeArticleScore,defaultValue:a.score},E.a.createElement(b["a"],{value:2},"2"),E.a.createElement(b["a"],{value:1},"1"),E.a.createElement(b["a"],{value:0},"0")))),E.a.createElement("h4",{style:{marginTop:"10px"}},"\u8d1f\u5411\u64cd\u4f5c\u539f\u56e0:"),E.a.createElement("div",null,E.a.createElement(y["a"].Group,{onChange:this.onChangeArticleReason,defaultValue:a.reason},E.a.createElement("div",{style:{marginBottom:"5px"}},I["u"].map(e=>E.a.createElement(y["a"],{value:e,key:e,style:{margin:0,marginRight:"8px"}},e)))),E.a.createElement("div",{className:"oper-btns-wrapper-oppo"},E.a.createElement(s["a"],{type:"primary",onClick:this.onPassArticle},"\u91cd\u5ba1")))))}}var P=t("NWZ9");t.d(a,"default",function(){return T});var Y=h["a"].Option,N=20;class T extends E.a.PureComponent{constructor(e){super(e),this.onChangePage=(e=>{this.setState({loading:!0}),this.getDocList(e),window.scrollTo(0,0)}),this.onCatChange=(e=>{this.setState({cat:e})}),this.onTierChange=(e=>{this.setState({tier:e})}),this.onCtypeChange=(e=>{this.setState({ctype:e})}),this.onScoreChange=(e=>{this.setState({score:e})}),this.onAuditorChange=(e=>{this.setState({auditor:e.target.value})}),this.onAuditDateChange=((e,a)=>{this.setState({startDate:a[0],endDate:a[1]})}),this.onSearchAudited=(()=>{this.setState({searchDocid:"",loading:!0},()=>{this.getDocList(1)})}),this.onSearchByDocid=(e=>{this.setState({cat:"all",tier:"all",auditor:"",docList:[],count:0,pageIndex:1,score:["all"],searchDocid:e,loading:!0},()=>{this.getDocList(1)})}),this.exportData=(()=>{var e=this.state.count;if(e>0&&e<3e4){var a=this.state,t=a.cat,r=a.tier,n=a.score,l=a.auditor,o=(a.searchDocid,a.startDate),s=a.endDate,c=a.ctype,i="all"===t?"":t,d="all"===r?"":r,p=n.includes("all")?"":n.toString(),u="all"===c?"":c,h={docid:"",operation_state:"1",category:i,operations:"",scores:p,source_tier:d,operator_email:l,start:o+" 00:00:00",end:s+" 23:59:59",sort:"createAt",appid:"oppobrowser",ctype:u},g=Object.assign(h,{offset:0,count:e}),E=[{label:"docid",value:"doc_id"},{label:"\u6587\u7ae0\u9898\u76ee",value:"title"},{label:"\u66dd\u5149\u91cf",value:"cntView"},{label:"\u5165\u5ba1\u6838\u6c60\u65f6\u95f4",value:"insert_time"},{label:"\u5927\u7c7b",value:"category"},{label:"\u8d26\u53f7\u540d\u79f0",value:"source"},{label:"\u8d26\u53f7id",value:"media_id"},{label:"\u6e90\u8bc4\u7ea7",value:"source_tier"},{label:"\u53d1\u5e03\u65f6\u95f4",value:"date"},{label:"\u4f4e\u4fd7\u503c",value:"sc_dirty"},{label:"\u6807\u9898\u515a\u5c5e\u6027",value:"bait"},{label:"\u8bc4\u5206",value:"score"},{label:"\u8bc4\u4f30\u7ed3\u8bba",value:"reason"},{label:"\u5ba1\u6838\u4eba",value:"operator_email"},{label:"\u5ba1\u6838\u65f6\u95f4",value:"reviewed_time"}],v={method:"GET",url:"http://operationtoolservice.go2yd.int.yidian-inc.com/news-review/search-top-news",params:JSON.stringify(g),dir:"result",struct:E,filename:"OPPOtop2000\u5df2\u5ba1\u6838\u6587\u7ae0",fileType:"xlsx"};ydFile.start(v,function(e){})}else m["a"].warning("\u5bfc\u51fa\u7684\u6570\u636e\u8981\u5927\u4e8e0\u6761\uff0c\u5c0f\u4e8e3\u4e07\u6761")});var a=w()().subtract(3,"days").format("YYYY-MM-DD"),t=w()().format("YYYY-MM-DD");this.state={getDataMode:"load",cat:"all",tier:"all",auditor:"",startDate:a,endDate:t,docList:[],count:0,pageIndex:1,searchDocid:"",score:["all"],loading:!0,ctype:"all"}}componentDidMount(){this.getDocList(1),window.ydFile.set("sk","wKy3i0rEtHuGwRo2w4yJtZyVq4"),window.ydFile.set("approved_by",Object(O["a"])("username"))}getDocList(e){var a=this.state,t=a.cat,r=a.tier,n=a.score,l=a.auditor,o=a.searchDocid,s=a.startDate,c=a.endDate,i=a.ctype,d=(e-1)*N,p="all"===t?"":t,u="all"===r?"":r,h=n.includes("all")?"":n.toString(),g="all"===i?"":i;this.setState({docList:[]}),A.a.get("/api/proxy/".concat(k["a"].API_TOOLS_HOST,"/news-review/search-top-news"),{params:{docid:o,operation_state:"1",category:p,operations:"",scores:h,source_tier:u,operator_email:l,start:s+" 00:00:00",end:c+" 23:59:59",offset:d,count:N,sort:"createAt",appid:"oppobrowser",ctype:g}}).then(a=>{if("success"===a.data.status){var t=a.data.result;t.forEach(function(e){e.newscore=e.score,0===e.reason.length?e.reason=[""]:1===e.reason.length?e.reason=[e.reason]:e.reason=e.reason.split(","),e.reason.forEach(function(a,t){a.indexOf("\u5176\u4ed6")>-1&&(e.other_reason=a.split(":")[1],e.reason[t]="\u5176\u4ed6")})}),this.setState({docList:t,pageIndex:e,count:a.data.total,loading:!1})}else m["a"].error("\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5\uff01"),this.setState({loading:!1})})}render(){var e=this.state,a=e.cat,t=e.tier,m=e.score,g=e.docList,v=e.count,y=e.pageIndex,b=e.ctype;return E.a.createElement(E.a.Fragment,null,E.a.createElement("div",{className:"main-content-with-page-header"},E.a.createElement(u["a"],{bordered:!1,style:{minHeight:500}},E.a.createElement(p["a"],{offsetTop:0},E.a.createElement("div",{style:{background:"#fff",padding:"15px 0",borderBottom:"1px solid #ddd"}},E.a.createElement(d["a"],{layout:"inline"},E.a.createElement(d["a"].Item,{label:"\u6587\u7ae0\u5927\u7c7b"},E.a.createElement(h["a"],{onChange:this.onCatChange,style:{width:150},value:a},E.a.createElement(Y,{value:"all"},"\u5168\u90e8"),P["a"].map(e=>E.a.createElement(Y,{value:e},e)))),E.a.createElement(d["a"].Item,{label:"\u8bc4\u5206"},E.a.createElement(h["a"],{mode:"multiple",style:{width:150},onChange:this.onScoreChange,value:m},E.a.createElement(Y,{value:"all"},"\u5168\u90e8"),E.a.createElement(Y,{value:0},"0"),E.a.createElement(Y,{value:1},"1"),E.a.createElement(Y,{value:2},"2"))),E.a.createElement(d["a"].Item,{label:"\u6e90\u8bc4\u7ea7"},E.a.createElement(h["a"],{onChange:this.onTierChange,style:{width:150},value:t},E.a.createElement(Y,{value:"all"},"\u5168\u90e8"),E.a.createElement(Y,{value:"1"},"1"),E.a.createElement(Y,{value:"2"},"2"),E.a.createElement(Y,{value:"3"},"3"),E.a.createElement(Y,{value:"4"},"4"),E.a.createElement(Y,{value:"5"},"5"),E.a.createElement(Y,{value:"6"},"6"))),E.a.createElement(d["a"].Item,{label:"\u5185\u5bb9\u7c7b\u578b"},E.a.createElement(h["a"],{onChange:this.onCtypeChange,style:{width:150},value:b},E.a.createElement(Y,{value:"all"},"\u5168\u90e8"),E.a.createElement(Y,{value:"\u56fe\u6587"},"\u56fe\u6587"),E.a.createElement(Y,{value:"\u89c6\u9891"},"\u89c6\u9891"))),E.a.createElement(d["a"].Item,{label:"\u5ba1\u6838\u5458\u8d26\u53f7"},E.a.createElement(i["a"],{placeholder:"\u8bf7\u8f93\u5165\u516c\u53f8\u90ae\u7bb1",onChange:this.onAuditorChange,style:{width:180},allowClear:!0})),E.a.createElement(d["a"].Item,{label:"\u5ba1\u6838\u65f6\u95f4"},E.a.createElement(c["a"].RangePicker,{defaultValue:[w()().subtract(3,"days"),w()()],format:"YYYY-MM-DD",onChange:this.onAuditDateChange})),E.a.createElement(d["a"].Item,null,E.a.createElement(s["a"],{type:"primary",onClick:this.onSearchAudited},"\u641c\u7d22"),E.a.createElement(o["a"],{content:"\u5bfc\u51fa\u7684\u6570\u636e\u8981\u5728\u4e00\u4e07\u6761\u4ee5\u5185,\u5426\u5219\u53ef\u80fd\u5bfc\u51fa\u5931\u8d25"},E.a.createElement(s["a"],{type:"danger",style:{marginLeft:"15px"},onClick:this.exportData},"\u5bfc\u51fa\u6570\u636e")))),E.a.createElement("div",{style:{marginTop:"15px"}},E.a.createElement(i["a"].Search,{style:{width:300},placeholder:"\u6309docid\u641c\u7d22\u53cd\u9988\u6587\u7ae0",onSearch:this.onSearchByDocid,enterButton:!0})),E.a.createElement(l["a"],{style:{background:"#fff",padding:"15px 0",borderBottom:"1px solid #ddd"},current:y,defaultCurrent:1,pageSize:N,total:v,showTotal:e=>"\u5171".concat(e,"\u6761"),onChange:this.onChangePage}))),E.a.createElement(n["a"],{spinning:this.state.loading},E.a.createElement("div",{className:"doc-list"},g&&g.map((e,a)=>E.a.createElement(L,{key:e.docid,index:a,doc:e})))),E.a.createElement(r["a"],null))))}}},wgAA:function(e,a,t){e.exports={"audit-doc-wrapper":"audit-doc-wrapper","doc-info":"doc-info","audit-info":"audit-info","doc-comments":"doc-comments","doc-oper-wrapper":"doc-oper-wrapper","opt-title":"opt-title","opt-wrapper":"opt-wrapper","oper-btns-wrapper-oppo":"oper-btns-wrapper-oppo"}}}]);