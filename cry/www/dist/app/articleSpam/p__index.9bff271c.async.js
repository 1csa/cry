(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[11],{GMg6:function(e,t,a){e.exports={"audit-doc-wrapper":"audit-doc-wrapper","doc-info":"doc-info","ant-tag":"ant-tag","doc-comments":"doc-comments","doc-oper":"doc-oper","oper-btns":"oper-btns"}},QeBL:function(e,t,a){"use strict";a.r(t);a("stmH");var n=a("5O1y"),c=(a("qXJo"),a("rAmn")),o=(a("42uY"),a("lGXO")),l=(a("oeo2"),a("BmDy")),r=(a("zI7Q"),a("SCaQ")),s=(a("vgpD"),a("UL5a")),i=(a("gFku"),a("7WSx")),d=(a("M6c6"),a("jMRu")),m=a("JCfe"),u=a.n(m),h=(a("ljfu"),a("x2dm")),g=a("ERkP"),p=a.n(g),v=(a("LCbC"),a("NwOV")),E=(a("Yzaq"),a("d+ro")),C=(a("IJu9"),a("DuHN")),f=(a("oj2R"),a("/zI6")),y=a("5ozA"),D=a("ggb3"),b=a.n(D),A=a("5W1r"),w=a("wknW"),S=a("wZVN");a("GMg6");class k extends p.a.PureComponent{constructor(e){super(e),this.onChangeArticleType=(e=>{this.setState({label:e.target.value})}),this.handleDeleteComment=(e=>{var t=this.state.comments;t=t.filter(t=>t.id!==e),this.setState({comments:t})}),this.onPassArticle=(()=>{var e=this;f["a"].confirm({title:"\u63d0\u793a",content:"\u60a8\u786e\u5b9a\u8981\u901a\u8fc7\u8be5\u6587\u7ae0\u5417\uff1f",onOk(){return e.handleArticle("checkDoc")}})}),this.onHideArticle=(()=>{var e=this;f["a"].confirm({title:"\u63d0\u793a",content:"\u60a8\u786e\u5b9a\u8981\u4e0d\u5c55\u793a\u8be5\u6587\u7ae0\u5417\uff1f(\u6536\u85cf \u548c \u5206\u4eab \u4e2d\u4fdd\u7559)",onOk(){return e.handleArticle("hide")}})}),this.onNoserveArticle=(()=>{var e=this;f["a"].confirm({title:"\u63d0\u793a",content:"\u60a8\u786e\u5b9a\u8981\u4e0d\u670d\u52a1\u8be5\u6587\u7ae0\u5417\uff1f(\u6536\u85cf \u5206\u4eab \u548c \u6e90\u8ba2\u9605 \u4e2d\u4fdd\u7559)",onOk(){return e.handleArticle("notserve")}})}),this.onNorecArticle=(()=>{var e=this;f["a"].confirm({title:"\u63d0\u793a",content:"\u60a8\u786e\u5b9a\u8981\u4e0d\u63a8\u8350\u8be5\u6587\u7ae0\u5417\uff1f(\u6536\u85cf \u5206\u4eab \u6e90\u8ba2\u9605 \u53ca \u81ea\u8350\u9891\u9053\uff0f\u641c\u7d22 \u4e2d\u4fdd\u7559)",onOk(){return e.handleArticle("notrecommend")}})}),this.onDeleteArticle=(()=>{var e=this;f["a"].confirm({title:"\u63d0\u793a",content:"\u60a8\u786e\u5b9a\u8981\u5220\u9664\u8be5\u6587\u7ae0\u5417\uff1f",onOk(){return e.deleteArticle()}})}),this.state={comments:this.props.doc.comments||[],label:""}}handleArticle(e){var t=this.props.doc,a=this.state.label;b.a.get("/api/proxy/".concat(w["a"].API_HOST,"/service/comment/review"),{params:{action:e,docid:t.docid,newsLabel:a,auditor:Object(S["a"])("username")||""}}).then(a=>{"success"===a.data.status?(this.props.handleRemoveDoc(t.docid),Object(A["saveLog"])({log_source:{tag:"articleSpam"},action_method:e,target_data:{docid:t.docid}})):C["a"].error("".concat(e,"\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"))}).catch(t=>{C["a"].error("".concat(e,"\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"))})}deleteArticle(){var e=this.props.doc,t=this.state.label;b.a.get("/api/proxy/".concat(w["a"].API_HOST,"/service/comment/review"),{params:{action:"removeDoc",docid:e.docid,newsLabel:t,auditor:Object(S["a"])("username")||""}}).then(t=>{"success"===t.data.status?(this.props.handleRemoveDoc(e.docid),Object(A["saveLog"])({log_source:{tag:"articleSpam"},action_method:"removeDoc",target_data:{docid:e.docid}})):C["a"].error("\u5220\u9664\u6587\u7ae0\u64cd\u4f5c\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5")})}render(){var e=this.props,t=e.doc,a=e.index,n=this.state,c=n.comments,o=n.label;return p.a.createElement("div",{className:"audit-doc-wrapper"},p.a.createElement("div",{className:"doc-title"},p.a.createElement("span",null,a+1,".\xa0\xa0"),p.a.createElement(r["a"],{type:"primary",href:"https://www.baidu.com/s?wd=".concat(t.title),target:"_blank"},"\u767e\u5ea6\u4e00\u4e0b"),p.a.createElement("a",{href:"https://www.yidianzixun.com/article/".concat(t.docid),target:"_blank"},t.title)),p.a.createElement("div",{className:"doc-info"},t.wemedia&&p.a.createElement(E["a"],{color:"#2db7f5"},"\u81ea\u5a92\u4f53"),t.stky&&p.a.createElement(E["a"],{color:"red"},"\u7f6e\u9876"),t.sel&&p.a.createElement(E["a"],{color:"orange"},"\u52a0\u7cbe"),p.a.createElement("span",null,p.a.createElement("strong",null,"\u5927\u7c7b: "),t.cat_class&&t.cat_class.join(",")),p.a.createElement("span",null,p.a.createElement("strong",null,"\u6587\u7ae0\u6e90: "),t.source),p.a.createElement("span",null,p.a.createElement("strong",null,"\u6e90\u8bc4\u7ea7: "),t.source_tier),p.a.createElement("span",null,p.a.createElement("strong",null,"\u53d1\u5e03\u65e5\u671f: "),t.date),p.a.createElement("span",null,p.a.createElement("strong",null,"docid: "),t.docid)),p.a.createElement("div",{className:"doc-comments"},c.map((e,a)=>p.a.createElement(y["a"],{key:e.id,index:a,docid:t.docid,comment:e,hasDelete:!0,handleDeleteComment:this.handleDeleteComment}))),p.a.createElement("div",{className:"doc-oper"},p.a.createElement("h4",null,"\u4f60\u89c9\u5f97\u7684\u6587\u7ae0\u7c7b\u578b?"),p.a.createElement("div",null,p.a.createElement(v["a"].Group,{onChange:this.onChangeArticleType,value:o},p.a.createElement("div",{style:{marginBottom:"5px"}},p.a.createElement(v["a"],{value:"\u5783\u573e\u89e3\u8bf4"},"\u5783\u573e\u89e3\u8bf4"),p.a.createElement(v["a"],{value:"\u6c34\u6587"},"\u6c34\u6587"),p.a.createElement(v["a"],{value:"\u5783\u573e\u6587"},"\u5783\u573e\u6587"),p.a.createElement(v["a"],{value:"\u65e7\u95fb\u3001\u8fc7\u65f6"},"\u65e7\u95fb\u3001\u8fc7\u65f6"),p.a.createElement(v["a"],{value:"\u8f6f\u6587\u5e7f\u544a"},"\u8f6f\u6587\u5e7f\u544a")),p.a.createElement("div",{style:{marginBottom:"5px"}},p.a.createElement(v["a"],{value:"\u865a\u5047"},"\u865a\u5047"),p.a.createElement(v["a"],{value:"\u63d2\u5e7f\u544a"},"\u63d2\u5e7f\u544a"),p.a.createElement(v["a"],{value:"\u6807\u9898\u515a"},"\u6807\u9898\u515a"),p.a.createElement(v["a"],{value:"\u6587\u4e0d\u5bf9\u9898"},"\u6587\u4e0d\u5bf9\u9898"),p.a.createElement(v["a"],{value:"\u9519\u522b\u5b57"},"\u9519\u522b\u5b57")),p.a.createElement("div",null,p.a.createElement(v["a"],{value:"\u8272\u60c5"},"\u8272\u60c5"),p.a.createElement(v["a"],{value:"\u8272\u60c5\u6f2b\u753b"},"\u8272\u60c5\u6f2b\u753b"),p.a.createElement(v["a"],{value:"\u51c6\u8272\u60c5"},"\u51c6\u8272\u60c5"))),p.a.createElement("div",{className:"oper-btns"},p.a.createElement(r["a"],{style:{backgroundColor:"#2fda2f",color:"#fff"},onClick:this.onPassArticle},"\u901a\u8fc7"),p.a.createElement(r["a"],{style:{backgroundColor:"#ee82ee",color:"#fff"},onClick:this.onHideArticle,disabled:!o},"\u4e0d\u5c55\u793a"),p.a.createElement(r["a"],{style:{backgroundColor:"#ff8c00",color:"#fff"},onClick:this.onNoserveArticle,disabled:!o},"\u4e0d\u670d\u52a1"),p.a.createElement(r["a"],{style:{backgroundColor:"#d2691e",color:"#fff"},onClick:this.onNorecArticle,disabled:!o},"\u4e0d\u63a8\u8350"),p.a.createElement(r["a"],{onClick:this.onDeleteArticle,disabled:!o},"\u5220\u9664")))))}}var x=a("NWZ9"),L=a("rpna");a("XfOM");a.d(t,"default",function(){return O});var _=h["a"].Option,I=20;class O extends p.a.PureComponent{constructor(e){super(e),this.onChangePage=(e=>{this.setState({loading:!0}),"load"===this.state.getDataMode?this.getAuditDocList(e):this.getAuditDocListBySearch(e),window.scrollTo(0,0)}),this.handleRemoveDoc=(e=>{var t=this.state.docList;t=t.filter(t=>t.docid!==e),this.setState({docList:t})}),this.onSearchByDocid=(e=>{this.setState({loading:!0}),b.a.get("/api/proxy/".concat(w["a"].API_HOST,"/service/comment/review"),{params:{action:"getPendingDocByDocid",docid:e}}).then(e=>{"success"===e.data.status&&(e.data.result&&e.data.result.length>0?this.getDocDetail(e.data.result).then(e=>{this.setState({docList:e,pageIndex:1,count:1,loading:!1})}):this.setState({docList:[],pageIndex:1,count:0,loading:!1}))})}),this.onSearchAudit=(()=>{this.setState({loading:!0}),this.getAuditDocListBySearch(1)}),this.onCatChange=(e=>{this.setState({cat:e})}),this.onNegChange=(e=>{this.setState({negCommentClass:e})}),this.onTierChange=(e=>{this.setState({tier:e})}),this.state={getDataMode:"load",cat:"all",negCommentClass:"all",tier:"all",docList:[],count:0,pageIndex:1,loading:!0}}componentDidMount(){this.getAuditDocList(1)}getDocDetail(e){var t=e.map(e=>e.docid);return b.a.get("/api/proxy/http://tool-collection.ha.in.yidian.com:7080/docenter/yidian/ids/".concat(t,"/fields/source,cat_class,source_tier,_id"),{params:{}}).then(t=>{return new Promise((a,n)=>{if("success"===t.data.status){var c={};t.data.result.forEach(e=>{e._id&&(c[e._id]=e)}),e=e.map(e=>{var t=c[e.docid];return t?u()({},e,t):e}),a(e)}else n()})})}getAuditDocList(e){b.a.get("/api/proxy/".concat(w["a"].API_HOST,"/service/comment/review"),{params:{action:"getDocToBeAudited",start:(e-1)*I,end:e*I}}).then(t=>{"success"===t.data.status&&this.getDocDetail(t.data.result.docs).then(a=>{this.setState({docList:a,pageIndex:e,count:t.data.result.count,loading:!1})})}).finally(()=>{this.setState({loading:!1})})}getAuditDocListBySearch(e){var t=this.state,a=t.cat,n=t.negCommentClass,c=t.tier,o={action:"getPendingDocByDivision",cat:a,negCommentClass:n,isAudited:!1,flag:"all",start:(e-1)*I,end:e*I};"all"!==c&&(o.tier=c),b.a.get("/api/proxy/".concat(w["a"].API_HOST,"/service/comment/review"),{params:o,headers:{"Content-Type":"application/json"}}).then(t=>{"success"===t.data.status&&(t.data.result&&t.data.result.docs&&t.data.result.count>0?this.getDocDetail(t.data.result.docs).then(a=>{this.setState({docList:a,pageIndex:e,count:t.data.result.count,getDataMode:"search",loading:!1})}):this.setState({docList:[],pageIndex:e,count:0,getDataMode:"search",loading:!1}))})}render(){var e=this.state,t=e.cat,a=e.negCommentClass,m=e.tier,u=e.docList,g=e.count,v=e.pageIndex;return p.a.createElement(p.a.Fragment,null,p.a.createElement("div",{className:"main-content"},p.a.createElement(d["a"],{bordered:!1,style:{minHeight:380}},p.a.createElement(i["a"],{offsetTop:0},p.a.createElement("div",{style:{background:"#fff",padding:"15px 0",borderBottom:"1px solid #ddd"}},p.a.createElement(s["a"],{layout:"inline"},p.a.createElement(s["a"].Item,{label:"\u6587\u7ae0\u5927\u7c7b"},p.a.createElement(h["a"],{onChange:this.onCatChange,style:{width:150},value:t},p.a.createElement(_,{value:"all"},"\u5168\u90e8"),x["a"].map(e=>p.a.createElement(_,{key:e,value:e},e)))),p.a.createElement(s["a"].Item,{label:"\u7528\u6237\u8d1f\u53cd\u9988\u7c7b\u578b"},p.a.createElement(h["a"],{onChange:this.onNegChange,style:{width:150},value:a},p.a.createElement(_,{value:"all"},"\u5168\u90e8"),L["a"].map(e=>p.a.createElement(_,{key:e,value:e},e)))),p.a.createElement(s["a"].Item,{label:"\u6e90\u8bc4\u7ea7"},p.a.createElement(h["a"],{onChange:this.onTierChange,style:{width:150},value:m},p.a.createElement(_,{value:"all"},"\u5168\u90e8"),p.a.createElement(_,{value:"1"},"1"),p.a.createElement(_,{value:"2"},"2"),p.a.createElement(_,{value:"3"},"3"),p.a.createElement(_,{value:"4"},"4"),p.a.createElement(_,{value:"5"},"5"),p.a.createElement(_,{value:"6"},"6"))),p.a.createElement(s["a"].Item,null,p.a.createElement(r["a"],{type:"primary",onClick:this.onSearchAudit},"\u641c\u7d22"))),p.a.createElement("div",{style:{marginTop:"15px"}},p.a.createElement(l["a"].Search,{style:{width:300},placeholder:"\u6309docid\u641c\u7d22\u53cd\u9988\u6587\u7ae0",onSearch:this.onSearchByDocid,enterButton:!0})),p.a.createElement(o["a"],{style:{marginTop:"15px"},current:v,defaultCurrent:1,pageSize:I,total:g,showTotal:e=>"\u5171".concat(e,"\u6761"),onChange:this.onChangePage}))),p.a.createElement(c["a"],{spinning:this.state.loading},p.a.createElement("div",{className:"doc-list"},u&&u.map((e,t)=>p.a.createElement(k,{key:e.docid,index:t,doc:e,handleRemoveDoc:this.handleRemoveDoc})))),p.a.createElement(n["a"],null))))}}}}]);